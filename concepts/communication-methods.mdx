---
title: 'M√©todos de Comunica√ß√£o'
description: 'API REST vs Monitorador de Pastas - Como escolher o melhor m√©todo para sua integra√ß√£o'
---

# M√©todos de Comunica√ß√£o

O Manager SaaS oferece duas formas principais de comunica√ß√£o para integra√ß√£o com sua aplica√ß√£o: **API REST** e **Monitorador de Pastas**. Cada m√©todo possui caracter√≠sticas espec√≠ficas e √© ideal para diferentes cen√°rios de uso.

## API REST

### **O que √©**

A **API REST** √© uma interface de programa√ß√£o baseada em HTTP que permite comunica√ß√£o direta e em tempo real com o Manager SaaS atrav√©s de requisi√ß√µes HTTPS.

### **Caracter√≠sticas**

<CardGroup cols={2}>
  <Card
    title="Vantagens"
    icon="check-circle"
  >
    - Comunica√ß√£o em tempo real
    - Respostas imediatas
    - Controle total do processo
    - Tratamento de erros detalhado
    - Webhooks para notifica√ß√µes
    - Rate limiting configur√°vel
  </Card>
  <Card
    title="Desvantagens"
    icon="x-circle"
  >
    - Requer conex√£o ativa
    - Maior complexidade de implementa√ß√£o
    - Necessita de tratamento de timeouts
    - Depend√™ncia de conectividade
  </Card>
</CardGroup>

### **Casos de Uso Ideais**

- **Aplica√ß√µes web** que precisam de respostas imediatas
- **Sistemas em tempo real** (POS, e-commerce)
- **Integra√ß√µes cr√≠ticas** que n√£o podem falhar
- **Aplica√ß√µes m√≥veis** que precisam de feedback instant√¢neo
- **Sistemas de monitoramento** que precisam de status em tempo real

### **Exemplo de Uso**

```php
<?php
// Emiss√£o de CT-e OS via API REST
function emitirCTeOS($dados) {
    try {
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, 'https://api.managersaas.com/v1/cte/os/emitir');
        curl_setopt($ch, CURLOPT_POST, true);
        curl_setopt($ch, CURLOPT_HTTPHEADER, [
            'Authorization: Bearer ' . $GLOBALS['token'],
            'Content-Type: application/json'
        ]);
        curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($dados));
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        
        $response = curl_exec($ch);
        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
        curl_close($ch);
        
        if ($httpCode !== 200) {
            throw new Exception("HTTP error! status: " . $httpCode);
        }
        
        return json_decode($response, true);
        
    } catch (Exception $error) {
        error_log('Erro na emiss√£o: ' . $error->getMessage());
        throw $error;
    }
}

// Uso
$resultado = emitirCTeOS([
    'tipo_documento' => 'CTE_OS',
    'emissor' => [ /* dados do emissor */ ],
    'tomador' => [ /* dados do tomador */ ],
    'servico' => [ /* dados do servi√ßo */ ]
]);

echo 'CT-e OS emitido: ' . print_r($resultado, true);
```

## Monitorador de Pastas

### **O que √©**

O **Monitorador de Pastas** √© um sistema que monitora diret√≥rios espec√≠ficos no seu servidor, processando automaticamente arquivos de texto estruturados para emiss√£o de documentos.

### **Caracter√≠sticas**

<CardGroup cols={2}>
  <Card
    title="Vantagens"
    icon="check-circle"
  >
    - Processamento em lote
    - N√£o requer conex√£o constante
    - Simples de implementar
    - Ideal para sistemas legados
    - Processamento ass√≠ncrono
    - Menor depend√™ncia de conectividade
  </Card>
  <Card
    title="Desvantagens"
    icon="x-circle"
  >
    - Sem resposta imediata
    - Necessita de monitoramento de status
    - Processamento sequencial
    - Menor controle sobre o processo
  </Card>
</CardGroup>

### **Casos de Uso Ideais**

- **Sistemas legados** que n√£o suportam APIs modernas
- **Processamento em lote** de grandes volumes
- **Integra√ß√µes com ERPs** tradicionais
- **Sistemas offline** ou com conectividade limitada
- **Migra√ß√µes de dados** e sincroniza√ß√µes

### **Estrutura de Pastas**

```
/manager-saas/
‚îú‚îÄ‚îÄ entrada/
‚îÇ   ‚îú‚îÄ‚îÄ cte/           # Arquivos de CT-e
‚îÇ   ‚îú‚îÄ‚îÄ nfe/           # Arquivos de NF-e
‚îÇ   ‚îú‚îÄ‚îÄ nfce/          # Arquivos de NFC-e
‚îÇ   ‚îú‚îÄ‚îÄ mdfe/          # Arquivos de MDF-e
‚îÇ   ‚îú‚îÄ‚îÄ cfe/           # Arquivos de CF-e
‚îÇ   ‚îî‚îÄ‚îÄ gnre/          # Arquivos de GNRE
‚îú‚îÄ‚îÄ saida/
‚îÇ   ‚îú‚îÄ‚îÄ processados/   # Arquivos processados com sucesso
‚îÇ   ‚îú‚îÄ‚îÄ erros/         # Arquivos com erro
‚îÇ   ‚îú‚îÄ‚îÄ logs/          # Logs de processamento
‚îÇ   ‚îî‚îÄ‚îÄ resultados/    # Resultados e arquivos gerados
‚îî‚îÄ‚îÄ config/
    ‚îî‚îÄ‚îÄ config.txt     # Arquivo de configura√ß√£o
```

### **Exemplo de Arquivo de Entrada**

```txt
# Arquivo: entrada/cte/cte_001.txt
TIPO_DOCUMENTO=CTE_OS
EMISSOR_CNPJ=12345678000199
EMISSOR_IE=123456789
EMISSOR_RAZAO_SOCIAL=TRANSPORTADORA EXEMPLO LTDA
EMISSOR_ENDERECO=Rua das Flores, 123
EMISSOR_BAIRRO=Centro
EMISSOR_MUNICIPIO=S√£o Paulo
EMISSOR_UF=SP
EMISSOR_CEP=01234-567
TOMADOR_CNPJ=98765432000188
TOMADOR_RAZAO_SOCIAL=CLIENTE EXEMPLO LTDA
TOMADOR_ENDERECO=Av. Paulista, 1000
TOMADOR_BAIRRO=Bela Vista
TOMADOR_MUNICIPIO=S√£o Paulo
TOMADOR_UF=SP
TOMADOR_CEP=01310-100
SERVICO_DESCRICAO=Transporte de carga geral
SERVICO_VALOR_FRETE=150.00
SERVICO_VALOR_SEGURO=25.00
SERVICO_VALOR_DESPESAS=15.00
SERVICO_VALOR_TOTAL=190.00
TRANSPORTE_TIPO_VEICULO=TRUCK
TRANSPORTE_PLACA=ABC1234
MOTORISTA_NOME=Jo√£o Silva
MOTORISTA_CPF=12345678901
MOTORISTA_CNH=12345678901
```

### **Arquivo de Configura√ß√£o**

```txt
# Arquivo: config/config.txt
API_URL=https://api.managersaas.com/v1
TOKEN=seu_token_aqui
EMPRESA_ID=seu_empresa_id
AMBIENTE=production
INTERVALO_MONITORAMENTO=30
PASTA_ENTRADA=/manager-saas/entrada
PASTA_SAIDA=/manager-saas/saida
PASTA_CONFIG=/manager-saas/config
LOG_LEVEL=INFO
MAX_TENTATIVAS=3
TEMPO_ESPERA=60
```

## Comparativo dos M√©todos

### **Por Caracter√≠stica**

| Caracter√≠stica | API REST | Monitorador de Pastas |
|----------------|----------|----------------------|
| **Tempo de Resposta** | Imediato | Ass√≠ncrono |
| **Complexidade** | M√©dia-Alta | Baixa |
| **Conectividade** | Requer conex√£o ativa | Funciona offline |
| **Processamento** | Individual | Em lote |
| **Controle** | Total | Limitado |
| **Implementa√ß√£o** | Requer c√≥digo | Arquivos de texto |
| **Monitoramento** | Em tempo real | Via arquivos de sa√≠da |
| **Escalabilidade** | Alta | M√©dia |

### **Por Volume de Documentos**

| Volume Di√°rio | M√©todo Recomendado | Justificativa |
|---------------|-------------------|---------------|
| **1-100** | API REST | Controle total e respostas imediatas |
| **100-1000** | API REST | Melhor performance e controle |
| **1000-10000** | H√≠brido | API para cr√≠ticos, monitorador para lote |
| **10000+** | Monitorador de Pastas | Melhor para processamento em massa |

### **Por Tipo de Sistema**

| Tipo de Sistema | M√©todo Recomendado | Justificativa |
|-----------------|-------------------|---------------|
| **Web/Mobile** | API REST | Interface em tempo real |
| **Desktop** | API REST | Controle e feedback |
| **ERP Tradicional** | Monitorador de Pastas | Integra√ß√£o simples |
| **Sistema Legado** | Monitorador de Pastas | Sem modifica√ß√µes no c√≥digo |
| **E-commerce** | API REST | Resposta imediata ao cliente |
| **Sistema POS** | API REST | Opera√ß√£o em tempo real |

## Implementa√ß√£o H√≠brida

### **Quando Usar**

A implementa√ß√£o h√≠brida combina os dois m√©todos para otimizar diferentes cen√°rios:

- **API REST** para opera√ß√µes cr√≠ticas e em tempo real
- **Monitorador de Pastas** para processamento em lote e backup

### **Exemplo de Implementa√ß√£o**

```php
<?php
class ManagerSaasClient {
    private $apiUrl;
    private $token;
    private $monitorPath;
    
    public function __construct($config) {
        $this->apiUrl = $config['apiUrl'];
        $this->token = $config['token'];
        $this->monitorPath = $config['monitorPath'];
    }
    
    // M√©todo principal - tenta API REST primeiro
    public function emitirDocumento($dados, $tipo) {
        try {
            // Tenta via API REST
            return $this->emitirViaAPI($dados, $tipo);
        } catch (Exception $error) {
            error_log('API REST falhou, usando monitorador: ' . $error->getMessage());
            
            // Fallback para monitorador de pastas
            return $this->emitirViaMonitorador($dados, $tipo);
        }
    }
    
    // Emiss√£o via API REST
    private function emitirViaAPI($dados, $tipo) {
        $endpoint = $this->getEndpoint($tipo);
        
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $this->apiUrl . $endpoint);
        curl_setopt($ch, CURLOPT_POST, true);
        curl_setopt($ch, CURLOPT_HTTPHEADER, [
            'Authorization: Bearer ' . $this->token,
            'Content-Type: application/json'
        ]);
        curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($dados));
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        
        $response = curl_exec($ch);
        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
        curl_close($ch);
        
        if ($httpCode !== 200) {
            throw new Exception("HTTP error! status: " . $httpCode);
        }
        
        return json_decode($response, true);
    }
    
    // Emiss√£o via Monitorador de Pastas
    private function emitirViaMonitorador($dados, $tipo) {
        $arquivo = $this->criarArquivoEntrada($dados, $tipo);
        $caminho = $this->monitorPath . '/entrada/' . $tipo . '/' . $arquivo;
        
        // Cria o arquivo de entrada
        $this->escreverArquivo($caminho, $dados);
        
        // Retorna identificador para acompanhamento
        return [
            'status' => 'enviado_para_monitorador',
            'arquivo' => $arquivo,
            'caminho' => $caminho,
            'timestamp' => date('c')
        ];
    }
    
    // Monitora resultado do monitorador
    public function monitorarResultado($arquivo, $tipo) {
        $caminhoResultado = $this->monitorPath . '/resultados/' . $tipo . '/' . $arquivo;
        
        // Verifica se o arquivo de resultado foi criado
        if ($this->arquivoExiste($caminhoResultado)) {
            $resultado = $this->lerArquivo($caminhoResultado);
            return json_decode($resultado, true);
        }
        
        return null;
    }
}
```

## Configura√ß√£o e Monitoramento

### **Configura√ß√£o da API REST**

```php
<?php
$config = [
    'apiUrl' => 'https://api.managersaas.com/v1',
    'token' => $_ENV['MANAGER_SAAS_TOKEN'],
    'timeout' => 30000,
    'retries' => 3,
    'webhooks' => [
        'url' => 'https://seu-site.com/webhook',
        'eventos' => ['documento_autorizado', 'documento_rejeitado']
    ]
];
```

### **Configura√ß√£o do Monitorador**

```bash
# Script de monitoramento
#!/bin/bash

CONFIG_FILE="/manager-saas/config/config.txt"
ENTRADA_DIR="/manager-saas/entrada"
SAIDA_DIR="/manager-saas/saida"

# Carrega configura√ß√µes
source "$CONFIG_FILE"

# Loop de monitoramento
while true; do
  # Processa cada tipo de documento
  for tipo in cte nfe nfce mdfe cfe gnre; do
    if [ -d "$ENTRADA_DIR/$tipo" ]; then
      for arquivo in "$ENTRADA_DIR/$tipo"/*.txt; do
        if [ -f "$arquivo" ]; then
          echo "Processando $arquivo..."
          
          # Envia para API
          curl -X POST "$API_URL/$tipo/emitir" \
            -H "Authorization: Bearer $TOKEN" \
            -H "Content-Type: application/json" \
            -d @"$arquivo" \
            -o "$SAIDA_DIR/resultados/$tipo/$(basename "$arquivo" .txt).json"
          
          # Move arquivo processado
          mv "$arquivo" "$SAIDA_DIR/processados/$tipo/"
          
          echo "Arquivo $arquivo processado"
        fi
      done
    fi
  done
  
  # Aguarda pr√≥ximo ciclo
  sleep "$INTERVALO_MONITORAMENTO"
done
```

## Pr√≥ximos Passos

<CardGroup cols={2}>
  <Card
    title="API REST"
    href="/api/endpoints/emission"
    icon="code"
  >
    Explore todos os endpoints da API
  </Card>
  <Card
    title="Monitorador de Pastas"
    href="/api/monitor/overview"
    icon="folder"
  >
    Configure o monitorador de pastas
  </Card>
  <Card
    title="Exemplos Pr√°ticos"
    href="/examples/php"
    icon="terminal"
  >
    Veja exemplos de implementa√ß√£o
  </Card>
  <Card
    title="Suporte"
    href="mailto:suporte@managersaas.com"
    icon="message-circle"
  >
    Entre em contato conosco
  </Card>
</CardGroup>

---

üîÑ **Escolha o m√©todo ideal**: Considere suas necessidades espec√≠ficas, volume de documentos e tipo de sistema para escolher entre API REST, Monitorador de Pastas ou uma combina√ß√£o h√≠brida. 