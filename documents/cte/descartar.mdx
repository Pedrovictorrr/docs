---
title: Descartar um Conhecimento OS
description: Documentação da rota para descartar CT-e OS rejeitados ou registrados
---

# Descartar um Conhecimento OS

A rota **descarta** será utilizada nos casos onde o CT-e OS foi rejeitado pela SEFAZ, porém precisamos enviar esse CT-e OS corrigido utilizando a mesma numeração do CT-e OS que foi rejeitado anteriormente.

**Importante:** Apenas os CT-e OS's com situação igual a `REJEITADA`, `REGISTRADA` ou `INUTILIZADA` estarão liberados para serem descartados.

## Endpoint

### POST

```http
POST https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/descarta
```

## Headers

| Nome | Descrição | Exemplo |
|------|-----------|---------|
| `Content-Type` | Indica o tipo de arquivo | `application/x-www-form-urlencoded` |
| `Authorization` | Este usuário e senha são os seus dados para logar como administrador em um grupo do SaaS | `Basic YWRtaW46MTIzbXVkYXI=` |

## Body Parameters

| Nome | Descrição |
|------|-----------|
| `Grupo` | Nome do grupo |
| `CNPJ` | CNPJ que está vinculado ao grupo que será usado para enviar a requisição de descarte, apenas números |
| `ChaveNota` | Chave da CT-e OS (44 dígitos) |
| `NumeroLote` | Número do lote do CT-e OS |

## Exemplos de Uso

### Exemplo 1: Descartar CT-e OS Rejeitado

```bash
curl -X POST "https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/descarta" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -H "Authorization: Basic YWRtaW46MTIzbXVkYXI=" \
  -d "Grupo=meugrupo&CNPJ=08187168000160&ChaveNota=41150408187168000160576660000006671000000012&NumeroLote=001"
```

### Exemplo 2: Descartar CT-e OS Registrado

```bash
curl -X POST "https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/descarta" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -H "Authorization: Basic YWRtaW46MTIzbXVkYXI=" \
  -d "Grupo=meugrupo&CNPJ=08187168000160&ChaveNota=41150408187168000160576660000006671000000013&NumeroLote=002"
```

## Respostas

### Exemplo de Retorno com Sucesso

Quando concluído com sucesso será retornado "OK, Operação realizada com sucesso".

```text
OK, Operação realizada com sucesso
```

### Exemplo de Retorno com Erro

```text
"Palavra Exception", "Classe da Exception", "Mensagem de Exception"
EXCEPTION, EspdCheckParamsException, Somente CTe-OS REJEITADA\delimiter INUTILIZADA\delimiter REGISTRADA ou IMPORTADA(Não autorizada) pode ser descartada.
```

## Situações Permitidas para Descarte

### ✅ **Situações que PERMITEM descarte:**

1. **`REJEITADA`** - CT-e OS rejeitado pela SEFAZ
2. **`REGISTRADA`** - CT-e OS registrado mas não autorizado
3. **`INUTILIZADA`** - CT-e OS inutilizado
4. **`IMPORTADA (Não autorizada)`** - CT-e OS importado mas não autorizado

### ❌ **Situações que NÃO permitem descarte:**

1. **`AUTORIZADA`** - CT-e OS autorizado pela SEFAZ
2. **`CANCELADA`** - CT-e OS cancelado
3. **`DENEGADA`** - CT-e OS denegado
4. **`EM PROCESSAMENTO`** - CT-e OS em processamento

## Parâmetros Obrigatórios

1. **`Grupo`** - Nome do grupo configurado no SaaS
2. **`CNPJ`** - CNPJ vinculado ao grupo (apenas números)
3. **`ChaveNota`** - Chave de acesso do CT-e OS (44 dígitos)
4. **`NumeroLote`** - Número do lote do CT-e OS

## Casos de Uso

### 1. **CT-e OS Rejeitado pela SEFAZ**
- Situação: `REJEITADA`
- Motivo: Erros de validação, dados incorretos, etc.
- Ação: Descartar para reutilizar a numeração

### 2. **CT-e OS Registrado mas Não Autorizado**
- Situação: `REGISTRADA`
- Motivo: Aguardando autorização ou processamento
- Ação: Descartar para cancelar o registro

### 3. **CT-e OS Inutilizado**
- Situação: `INUTILIZADA`
- Motivo: Numeração não utilizada
- Ação: Descartar para liberar a numeração

### 4. **CT-e OS Importado Não Autorizado**
- Situação: `IMPORTADA (Não autorizada)`
- Motivo: CT-e OS importado mas sem autorização
- Ação: Descartar para cancelar a importação

## Fluxo de Descarte

```
CT-e OS Rejeitado/Registrado
           ↓
    Verificar Situação
           ↓
    Confirmar Elegibilidade
           ↓
    Executar Descarte
           ↓
    Numeração Liberada
           ↓
    Emitir Novo CT-e OS
```

## Observações Importantes

1. **Numeração Reutilizável**: Após o descarte, a numeração do CT-e OS pode ser reutilizada
2. **Histórico Preservado**: O histórico do CT-e OS descartado é mantido no sistema
3. **Permissões**: É necessário ter permissões de administrador no grupo
4. **Validação**: O sistema valida automaticamente se o CT-e OS pode ser descartado
5. **Lote**: O número do lote é obrigatório para identificação

## Tratamento de Erros

### Erros Comuns

- **"Somente CTe-OS REJEITADA, INUTILIZADA, REGISTRADA ou IMPORTADA pode ser descartada"** - CT-e OS não está em situação permitida para descarte
- **"CT-e OS não encontrado"** - Chave informada não existe no sistema
- **"CNPJ não vinculado ao grupo"** - CNPJ não está associado ao grupo informado
- **"Sem permissão"** - Usuário não tem permissões de administrador

### Validações

1. Verificar se o CT-e OS existe no sistema
2. Confirmar se a situação permite descarte
3. Validar se o CNPJ está ativo no grupo
4. Verificar se o usuário tem permissões adequadas
5. Confirmar se o número do lote está correto

## Exemplo de Fluxo Completo

### Passo 1: Verificar Situação
```bash
# Consultar situação do CT-e OS
GET /cteos/consulta?grupo=meugrupo&cnpj=08187168000160&filtro=chave=41150408187168000160576660000006671000000012&campos=situacao,chave&limite=1
```

### Passo 2: Executar Descarte
```bash
# Descartar CT-e OS rejeitado
POST /cteos/descarta
Body: Grupo=meugrupo&CNPJ=08187168000160&ChaveNota=41150408187168000160576660000006671000000012&NumeroLote=001
```

### Passo 3: Verificar Sucesso
```text
Resposta: OK, Operação realizada com sucesso
```

### Passo 4: Emitir Novo CT-e OS
```bash
# Agora é possível emitir um novo CT-e OS com a mesma numeração
POST /cteos/envia
# ... parâmetros do novo CT-e OS
```