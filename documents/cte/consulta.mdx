---
title: Consultar um Conhecimento OS
description: Documentação da rota de consulta para buscar informações específicas do CT-e OS
---

# Consultar um Conhecimento OS

A rota **consulta** é utilizada para consultarmos campos específicos do CT-e OS dentro do servidor.

## Endpoint

### GET

```http
GET https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/consulta
```

## Headers

| Nome | Descrição | Exemplo |
|------|-----------|---------|
| `Authorization` | Este usuário e senha são os seus dados para logar como administrador em um grupo do SaaS | `Basic YWRtaW46MTIzbXVkYXI=` |

## Query Parameters

| Nome | Descrição |
|------|-----------|
| `Grupo` | Nome do grupo |
| `CNPJ` | CNPJ que está vinculado ao grupo que será usado para realizar a consulta, apenas números |
| `Filtro` | Aqui você vai informar o filtro da sua consulta, exemplo: `situacao = AUTORIZADA and dtautorizacao = 02/08/2017 10:59:41` |
| `Campos` | Aqui você vai informar todos os campos que deseja obter da consulta, eles são separados por vírgula, exemplo: `chave, nprotenvio` |
| `Limite` | **Limite de registros que a consulta deve retornar**<br/>**Atenção!** O valor máximo e também padrão é de **100 registros** |
| `Ordem` | Ordena a consulta |
| `Visao` | Determina em qual tabela a consulta será realizada, exemplo: `Visao=TspdCTeOSVWConsulta` |

## Campos Disponíveis para Consulta

| Campo | Descrição |
|-------|-----------|
| `idintegracao` | Número do idintegração |
| `situacao` | Situação do CT-e OS |
| `numero` | Número do CT-e OS |
| `codct` | Código numérico que compõe a Chave de Acesso |
| `nprotenvio` | Número do protocolo de envio do CT-e OS (15 dígitos) |
| `nprotcanc` | Número do protocolo de cancelamento do CT-e OS (15 dígitos) |
| `nprotinutil` | Número do protocolo de inutilização do CT-e OS (15 dígitos) |
| `modoentrada` | Modo de entrada Normal, EPEC, FSDA, SVSRS, SVCSP |
| `dtemissao` | Data de emissão do CT-e OS |
| `email` | E-mail do Tomador |
| `handle` | Handle do CT-e OS (Identificador único do registro) |
| `chave` | Chave do CT-e OS (44 dígitos) |
| `dtautorizacao` | Data de autorização do CT-e OS |
| `dtcancelamento` | Data de cancelamento do CT-e OS |
| `cnpj` | CNPJ do Emitente |
| `idgrupo` | Número do ID do grupo |
| `serie` | Série do CT-e OS |
| `nomegrupo` | Nome do Grupo configurado no SaaS |
| `docdestinatario` | CNPJ do Destinatário |
| `eventos` | Quantidade de eventos que o CT-e OS recebeu |
| `origem` | Determina a origem dos registros que serão obtidos:<br/>`1` - Emitidas à Terceiros<br/>`2` - Recebidas de Terceiros<br/>`3` - Operação Interna<br/>`4` - Todas |
| `tomador` | Indica o papel do tomador do serviço no CT-e OS:<br/>`0` – Remetente<br/>`1` – Expedidor<br/>`2` – Recebedor<br/>`3` – Destinatário |
| `nomedestinatario` | Nome do Destinatário |
| `xmlcteosautorizado` | XML autorizado do CT-e OS |
| `doctomador` | CNPJ do Tomador do CT-e OS |
| `docremetente` | CNPJ do Remetente do CT-e OS |
| `docexpedidor` | CNPJ do Expedidor do CT-e OS |
| `docrecebedor` | CNPJ do Expedidor do CT-e OS |
| `dtcadastro` | Data de cadastro do CT-e OS no EDoc/SaaS |
| `ambiente` | Ambiente de Emissão:<br/>`1` - Produção<br/>`2` - Homologação |
| `impressora` | Nome da Impressora configurada como padrão |
| `motivo` | Mensagem de Autorização ou Rejeição do CT-e OS |
| `cstat` | Número do cstat retornado pela SEFAZ |
| `sincronizadopm` | Sincronização com o PrintManager:<br/>`0` - Não sincronizado<br/>`1` - Sincronizado |
| `impresso` | Impressão do CT-e OS:<br/>`Sim` - CT-e OS Impressa<br/>`Não` - CT-e OS não impressa |
| `emailtomador` | E-mail do Tomador |
| `envemail` | Envio de e-mail da CT-e OS:<br/>`Sim` - Envio de e-mail da CT-e OS realizado<br/>`Não` - Envio de e-mail da CT-e OS não realizado |

## Exemplos de Uso

### Exemplo 1: Consulta Básica
```http
GET https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/consulta?grupo=meugrupo&cnpj=08187168000160&campos=chave,situacao,serie&limite=50
```

### Exemplo 2: Consulta com Filtro
```http
GET https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/consulta?grupo=meugrupo&cnpj=08187168000160&filtro=situacao=AUTORIZADA&campos=chave,dtemissao,dtautorizacao&limite=100
```

### Exemplo 3: Consulta com Filtro Composto
```http
GET https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/consulta?grupo=meugrupo&cnpj=08187168000160&filtro=situacao=AUTORIZADA and dtautorizacao=02/08/2017 10:59:41&campos=chave,nprotenvio,serie&limite=50
```

### Exemplo 4: Consulta com Visão Específica
```http
GET https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/consulta?grupo=meugrupo&cnpj=08187168000160&visao=TspdCTeOSVWConsulta&campos=chave,situacao,ambiente&limite=100
```

## Respostas

### Exemplo de Retorno com Sucesso

Será de acordo com os campos e ordem informada no parâmetro "campos".

**Exemplo:** Filtro: `chave, situacao, serie`

```text
41150408187168000160576660000006671000000012, CANCELADA, 324
```

### Exemplo de Retorno com Erro

```text
Nenhum registro encontrado.
```

## Filtros Comuns

### Por Situação
- `situacao = AUTORIZADA` - CT-e OS autorizados
- `situacao = CANCELADA` - CT-e OS cancelados
- `situacao = REJEITADA` - CT-e OS rejeitados
- `situacao = PENDENTE` - CT-e OS pendentes

### Por Data
- `dtemissao = 02/08/2017` - Por data de emissão específica
- `dtautorizacao >= 01/08/2017` - Por data de autorização a partir de
- `dtemissao between 01/08/2017 and 31/08/2017` - Por período de emissão

### Por Ambiente
- `ambiente = 1` - Produção
- `ambiente = 2` - Homologação

### Por Origem
- `origem = 1` - Emitidas à Terceiros
- `origem = 2` - Recebidas de Terceiros
- `origem = 3` - Operação Interna
- `origem = 4` - Todas

### Por Tomador
- `tomador = 0` - Remetente
- `tomador = 1` - Expedidor
- `tomador = 2` - Recebedor
- `tomador = 3` - Destinatário

## Operadores de Filtro

### Operadores de Comparação
- `=` - Igual
- `<>` - Diferente
- `>` - Maior que
- `<` - Menor que
- `>=` - Maior ou igual
- `<=` - Menor ou igual

### Operadores Lógicos
- `and` - E lógico
- `or` - OU lógico
- `not` - NÃO lógico

### Operadores de Texto
- `like` - Contém (ex: `situacao like 'AUTORIZADA'`)
- `in` - Está em lista (ex: `situacao in ('AUTORIZADA', 'CANCELADA')`)

## Limitações e Considerações

1. **Limite de Registros**: Máximo de 100 registros por consulta
2. **Performance**: Consultas com muitos campos podem ser mais lentas
3. **Filtros Complexos**: Use filtros específicos para melhor performance
4. **Visão Padrão**: Se não especificar a visão, será usada a visão padrão do sistema
5. **Ordenação**: Use o parâmetro `ordem` para organizar os resultados conforme necessário

## Casos de Uso Comuns

### 1. Relatório de CT-e OS Autorizados
```http
GET /cteos/consulta?grupo=meugrupo&cnpj=08187168000160&filtro=situacao=AUTORIZADA&campos=chave,dtemissao,dtautorizacao,serie,numero&limite=100
```

### 2. Consulta de CT-e OS por Período
```http
GET /cteos/consulta?grupo=meugrupo&cnpj=08187168000160&filtro=dtemissao between 01/01/2024 and 31/01/2024&campos=chave,situacao,dtemissao&limite=100
```

### 3. Verificação de Status de Envio
```http
GET /cteos/consulta?grupo=meugrupo&cnpj=08187168000160&filtro=situacao in ('AUTORIZADA', 'REJEITADA')&campos=chave,situacao,motivo,cstat&limite=100
```