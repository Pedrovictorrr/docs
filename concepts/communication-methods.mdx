---
title: 'Métodos de Comunicação'
description: 'API REST vs Monitorador de Pastas - Como escolher o melhor método para sua integração'
---

# Métodos de Comunicação

O Manager SaaS oferece duas formas principais de comunicação para integração com sua aplicação: **API REST** e **Monitorador de Pastas**. Cada método possui características específicas e é ideal para diferentes cenários de uso.

## API REST

### **O que é**

A **API REST** é uma interface de programação baseada em HTTP que permite comunicação direta e em tempo real com o Manager SaaS através de requisições HTTPS.

### **Características**

<CardGroup cols={2}>
  <Card
    title="Vantagens"
    icon="check-circle"
  >
    - Comunicação em tempo real
    - Respostas imediatas
    - Controle total do processo
    - Tratamento de erros detalhado
    - Webhooks para notificações
    - Rate limiting configurável
  </Card>
  <Card
    title="Desvantagens"
    icon="x-circle"
  >
    - Requer conexão ativa
    - Maior complexidade de implementação
    - Necessita de tratamento de timeouts
    - Dependência de conectividade
  </Card>
</CardGroup>

### **Casos de Uso Ideais**

- **Aplicações web** que precisam de respostas imediatas
- **Sistemas em tempo real** (POS, e-commerce)
- **Integrações críticas** que não podem falhar
- **Aplicações móveis** que precisam de feedback instantâneo
- **Sistemas de monitoramento** que precisam de status em tempo real

### **Exemplo de Uso**

```javascript
// Emissão de CT-e OS via API REST
const emitirCTeOS = async (dados) => {
  try {
    const response = await fetch('https://api.managersaas.com/v1/cte/os/emitir', {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${token}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(dados)
    });
    
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    
    const result = await response.json();
    return result;
    
  } catch (error) {
    console.error('Erro na emissão:', error);
    throw error;
  }
};

// Uso
const resultado = await emitirCTeOS({
  tipo_documento: 'CTE_OS',
  emissor: { /* dados do emissor */ },
  tomador: { /* dados do tomador */ },
  servico: { /* dados do serviço */ }
});

console.log('CT-e OS emitido:', resultado);
```

## Monitorador de Pastas

### **O que é**

O **Monitorador de Pastas** é um sistema que monitora diretórios específicos no seu servidor, processando automaticamente arquivos de texto estruturados para emissão de documentos.

### **Características**

<CardGroup cols={2}>
  <Card
    title="Vantagens"
    icon="check-circle"
  >
    - Processamento em lote
    - Não requer conexão constante
    - Simples de implementar
    - Ideal para sistemas legados
    - Processamento assíncrono
    - Menor dependência de conectividade
  </Card>
  <Card
    title="Desvantagens"
    icon="x-circle"
  >
    - Sem resposta imediata
    - Necessita de monitoramento de status
    - Processamento sequencial
    - Menor controle sobre o processo
  </Card>
</CardGroup>

### **Casos de Uso Ideais**

- **Sistemas legados** que não suportam APIs modernas
- **Processamento em lote** de grandes volumes
- **Integrações com ERPs** tradicionais
- **Sistemas offline** ou com conectividade limitada
- **Migrações de dados** e sincronizações

### **Estrutura de Pastas**

```
/manager-saas/
├── entrada/
│   ├── cte/           # Arquivos de CT-e
│   ├── nfe/           # Arquivos de NF-e
│   ├── nfce/          # Arquivos de NFC-e
│   ├── mdfe/          # Arquivos de MDF-e
│   ├── cfe/           # Arquivos de CF-e
│   └── gnre/          # Arquivos de GNRE
├── saida/
│   ├── processados/   # Arquivos processados com sucesso
│   ├── erros/         # Arquivos com erro
│   ├── logs/          # Logs de processamento
│   └── resultados/    # Resultados e arquivos gerados
└── config/
    └── config.txt     # Arquivo de configuração
```

### **Exemplo de Arquivo de Entrada**

```txt
# Arquivo: entrada/cte/cte_001.txt
TIPO_DOCUMENTO=CTE_OS
EMISSOR_CNPJ=12345678000199
EMISSOR_IE=123456789
EMISSOR_RAZAO_SOCIAL=TRANSPORTADORA EXEMPLO LTDA
EMISSOR_ENDERECO=Rua das Flores, 123
EMISSOR_BAIRRO=Centro
EMISSOR_MUNICIPIO=São Paulo
EMISSOR_UF=SP
EMISSOR_CEP=01234-567
TOMADOR_CNPJ=98765432000188
TOMADOR_RAZAO_SOCIAL=CLIENTE EXEMPLO LTDA
TOMADOR_ENDERECO=Av. Paulista, 1000
TOMADOR_BAIRRO=Bela Vista
TOMADOR_MUNICIPIO=São Paulo
TOMADOR_UF=SP
TOMADOR_CEP=01310-100
SERVICO_DESCRICAO=Transporte de carga geral
SERVICO_VALOR_FRETE=150.00
SERVICO_VALOR_SEGURO=25.00
SERVICO_VALOR_DESPESAS=15.00
SERVICO_VALOR_TOTAL=190.00
TRANSPORTE_TIPO_VEICULO=TRUCK
TRANSPORTE_PLACA=ABC1234
MOTORISTA_NOME=João Silva
MOTORISTA_CPF=12345678901
MOTORISTA_CNH=12345678901
```

### **Arquivo de Configuração**

```txt
# Arquivo: config/config.txt
API_URL=https://api.managersaas.com/v1
TOKEN=seu_token_aqui
EMPRESA_ID=seu_empresa_id
AMBIENTE=production
INTERVALO_MONITORAMENTO=30
PASTA_ENTRADA=/manager-saas/entrada
PASTA_SAIDA=/manager-saas/saida
PASTA_CONFIG=/manager-saas/config
LOG_LEVEL=INFO
MAX_TENTATIVAS=3
TEMPO_ESPERA=60
```

## Comparativo dos Métodos

### **Por Característica**

| Característica | API REST | Monitorador de Pastas |
|----------------|----------|----------------------|
| **Tempo de Resposta** | Imediato | Assíncrono |
| **Complexidade** | Média-Alta | Baixa |
| **Conectividade** | Requer conexão ativa | Funciona offline |
| **Processamento** | Individual | Em lote |
| **Controle** | Total | Limitado |
| **Implementação** | Requer código | Arquivos de texto |
| **Monitoramento** | Em tempo real | Via arquivos de saída |
| **Escalabilidade** | Alta | Média |

### **Por Volume de Documentos**

| Volume Diário | Método Recomendado | Justificativa |
|---------------|-------------------|---------------|
| **1-100** | API REST | Controle total e respostas imediatas |
| **100-1000** | API REST | Melhor performance e controle |
| **1000-10000** | Híbrido | API para críticos, monitorador para lote |
| **10000+** | Monitorador de Pastas | Melhor para processamento em massa |

### **Por Tipo de Sistema**

| Tipo de Sistema | Método Recomendado | Justificativa |
|-----------------|-------------------|---------------|
| **Web/Mobile** | API REST | Interface em tempo real |
| **Desktop** | API REST | Controle e feedback |
| **ERP Tradicional** | Monitorador de Pastas | Integração simples |
| **Sistema Legado** | Monitorador de Pastas | Sem modificações no código |
| **E-commerce** | API REST | Resposta imediata ao cliente |
| **Sistema POS** | API REST | Operação em tempo real |

## Implementação Híbrida

### **Quando Usar**

A implementação híbrida combina os dois métodos para otimizar diferentes cenários:

- **API REST** para operações críticas e em tempo real
- **Monitorador de Pastas** para processamento em lote e backup

### **Exemplo de Implementação**

```javascript
class ManagerSaasClient {
  constructor(config) {
    this.apiUrl = config.apiUrl;
    this.token = config.token;
    this.monitorPath = config.monitorPath;
  }
  
  // Método principal - tenta API REST primeiro
  async emitirDocumento(dados, tipo) {
    try {
      // Tenta via API REST
      return await this.emitirViaAPI(dados, tipo);
    } catch (error) {
      console.warn('API REST falhou, usando monitorador:', error);
      
      // Fallback para monitorador de pastas
      return await this.emitirViaMonitorador(dados, tipo);
    }
  }
  
  // Emissão via API REST
  async emitirViaAPI(dados, tipo) {
    const endpoint = this.getEndpoint(tipo);
    
    const response = await fetch(`${this.apiUrl}${endpoint}`, {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${this.token}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(dados)
    });
    
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    
    return await response.json();
  }
  
  // Emissão via Monitorador de Pastas
  async emitirViaMonitorador(dados, tipo) {
    const arquivo = this.criarArquivoEntrada(dados, tipo);
    const caminho = `${this.monitorPath}/entrada/${tipo}/${arquivo}`;
    
    // Cria o arquivo de entrada
    await this.escreverArquivo(caminho, dados);
    
    // Retorna identificador para acompanhamento
    return {
      status: 'enviado_para_monitorador',
      arquivo: arquivo,
      caminho: caminho,
      timestamp: new Date().toISOString()
    };
  }
  
  // Monitora resultado do monitorador
  async monitorarResultado(arquivo, tipo) {
    const caminhoResultado = `${this.monitorPath}/resultados/${tipo}/${arquivo}`;
    
    // Verifica se o arquivo de resultado foi criado
    if (await this.arquivoExiste(caminhoResultado)) {
      const resultado = await this.lerArquivo(caminhoResultado);
      return JSON.parse(resultado);
    }
    
    return null;
  }
}
```

## Configuração e Monitoramento

### **Configuração da API REST**

```javascript
const config = {
  apiUrl: 'https://api.managersaas.com/v1',
  token: process.env.MANAGER_SAAS_TOKEN,
  timeout: 30000,
  retries: 3,
  webhooks: {
    url: 'https://seu-site.com/webhook',
    eventos: ['documento_autorizado', 'documento_rejeitado']
  }
};
```

### **Configuração do Monitorador**

```bash
# Script de monitoramento
#!/bin/bash

CONFIG_FILE="/manager-saas/config/config.txt"
ENTRADA_DIR="/manager-saas/entrada"
SAIDA_DIR="/manager-saas/saida"

# Carrega configurações
source "$CONFIG_FILE"

# Loop de monitoramento
while true; do
  # Processa cada tipo de documento
  for tipo in cte nfe nfce mdfe cfe gnre; do
    if [ -d "$ENTRADA_DIR/$tipo" ]; then
      for arquivo in "$ENTRADA_DIR/$tipo"/*.txt; do
        if [ -f "$arquivo" ]; then
          echo "Processando $arquivo..."
          
          # Envia para API
          curl -X POST "$API_URL/$tipo/emitir" \
            -H "Authorization: Bearer $TOKEN" \
            -H "Content-Type: application/json" \
            -d @"$arquivo" \
            -o "$SAIDA_DIR/resultados/$tipo/$(basename "$arquivo" .txt).json"
          
          # Move arquivo processado
          mv "$arquivo" "$SAIDA_DIR/processados/$tipo/"
          
          echo "Arquivo $arquivo processado"
        fi
      done
    fi
  done
  
  # Aguarda próximo ciclo
  sleep "$INTERVALO_MONITORAMENTO"
done
```

## Próximos Passos

<CardGroup cols={2}>
  <Card
    title="API REST"
    href="/api/endpoints/emission"
    icon="code"
  >
    Explore todos os endpoints da API
  </Card>
  <Card
    title="Monitorador de Pastas"
    href="/api/monitor/overview"
    icon="folder"
  >
    Configure o monitorador de pastas
  </Card>
  <Card
    title="Exemplos Práticos"
    href="/examples/php"
    icon="terminal"
  >
    Veja exemplos de implementação
  </Card>
  <Card
    title="Suporte"
    href="mailto:suporte@managersaas.com"
    icon="message-circle"
  >
    Entre em contato conosco
  </Card>
</CardGroup>

---

🔄 **Escolha o método ideal**: Considere suas necessidades específicas, volume de documentos e tipo de sistema para escolher entre API REST, Monitorador de Pastas ou uma combinação híbrida. 