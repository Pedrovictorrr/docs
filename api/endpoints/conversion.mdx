---
title: 'Convers√£o TX2 para XML'
description: 'Converte arquivos TX2 para XML com ou sem assinatura digital'
---

# Convers√£o TX2 para XML - CT-e OS

A rota de convers√£o permite transformar arquivos TX2 (formato de texto estruturado) em XML v√°lido para CT-e OS, com op√ß√£o de assinatura digital e diferentes formatos de retorno.

## Endpoint de Convers√£o

```http
POST https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/exportaxml
```

## Autentica√ß√£o

### **Headers Obrigat√≥rios**

```http
Content-Type: application/x-www-form-urlencoded
Authorization: Basic YWRtaW46MTIzbXVkYXI=
```

<Note>
üîê **Importante**: As credenciais de autentica√ß√£o s√£o as mesmas utilizadas para login como administrador no grupo do SaaS.
</Note>

## Par√¢metros da Requisi√ß√£o

### **Par√¢metros Obrigat√≥rios**

| Par√¢metro | Tipo | Descri√ß√£o | Exemplo |
|-----------|------|-----------|---------|
| `Grupo` | string | Nome do grupo configurado no SaaS | `GRUPO_EMPRESA` |
| `CNPJ` | string | CNPJ vinculado ao grupo (apenas n√∫meros) | `12345678000199` |
| `Arquivo` | file | Conte√∫do do arquivo TX2 | Conte√∫do bin√°rio do arquivo |
| `Converter` | number | Ativa convers√£o TX2 para XML | `1` (Sim), `0` (N√£o) |

### **Par√¢metros Opcionais**

| Par√¢metro | Tipo | Descri√ß√£o | Valores |
|-----------|------|-----------|---------|
| `Assinado` | number | XML com ou sem assinatura digital | `1` (Assinado), `0` (N√£o assinado) |
| `Url` | number | Formato de retorno | `0` (Conte√∫do), `1` (URL download) |

## Formato do Arquivo TX2

### **Estrutura B√°sica**

O arquivo TX2 √© um arquivo de texto estruturado com campos separados por quebras de linha. Cada linha cont√©m um campo espec√≠fico:

```txt
TIPO_DOCUMENTO=CTE_OS
EMISSOR_CNPJ=12345678000199
EMISSOR_IE=123456789
EMISSOR_RAZAO_SOCIAL=TRANSPORTADORA EXEMPLO LTDA
EMISSOR_ENDERECO=Rua das Flores, 123
EMISSOR_BAIRRO=Centro
EMISSOR_MUNICIPIO=S√£o Paulo
EMISSOR_UF=SP
EMISSOR_CEP=01234-567
TOMADOR_CNPJ=98765432000188
TOMADOR_RAZAO_SOCIAL=CLIENTE EXEMPLO LTDA
TOMADOR_ENDERECO=Av. Paulista, 1000
TOMADOR_BAIRRO=Bela Vista
TOMADOR_MUNICIPIO=S√£o Paulo
TOMADOR_UF=SP
TOMADOR_CEP=01310-100
SERVICO_DESCRICAO=Transporte de carga geral
SERVICO_VALOR_FRETE=150.00
SERVICO_VALOR_SEGURO=25.00
SERVICO_VALOR_DESPESAS=15.00
SERVICO_VALOR_TOTAL=190.00
TRANSPORTE_TIPO_VEICULO=TRUCK
TRANSPORTE_PLACA=ABC1234
MOTORISTA_NOME=Jo√£o Silva
MOTORISTA_CPF=12345678901
MOTORISTA_CNH=12345678901
```

### **Campos Obrigat√≥rios TX2**

| Campo | Descri√ß√£o | Exemplo |
|-------|-----------|---------|
| `TIPO_DOCUMENTO` | Tipo do documento | `CTE_OS` |
| `EMISSOR_CNPJ` | CNPJ do emissor | `12345678000199` |
| `EMISSOR_IE` | Inscri√ß√£o estadual | `123456789` |
| `EMISSOR_RAZAO_SOCIAL` | Raz√£o social | `TRANSPORTADORA EXEMPLO LTDA` |
| `EMISSOR_ENDERECO` | Endere√ßo completo | `Rua das Flores, 123` |
| `TOMADOR_CNPJ` | CNPJ do tomador | `98765432000188` |
| `SERVICO_DESCRICAO` | Descri√ß√£o do servi√ßo | `Transporte de carga geral` |
| `SERVICO_VALOR_FRETE` | Valor do frete | `150.00` |

## Exemplos de Requisi√ß√£o

### **1. Convers√£o com XML Assinado (Conte√∫do)**

```bash
curl -X POST "https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/exportaxml" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -H "Authorization: Basic YWRtaW46MTIzbXVkYXI=" \
  -d "Grupo=GRUPO_EMPRESA&CNPJ=12345678000199&Converter=1&Assinado=1&Url=0" \
  --data-binary @arquivo.txt
```

**Par√¢metros**:
- `Converter=1`: Ativa a convers√£o TX2 para XML
- `Assinado=1`: XML com assinatura digital
- `Url=0`: Retorna o conte√∫do do XML

### **2. Convers√£o sem Assinatura (URL Download)**

```bash
curl -X POST "https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/exportaxml" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -H "Authorization: Basic YWRtaW46MTIzbXVkYXI=" \
  -d "Grupo=GRUPO_EMPRESA&CNPJ=12345678000199&Converter=1&Assinado=0&Url=1" \
  --data-binary @arquivo.txt
```

**Par√¢metros**:
- `Converter=1`: Ativa a convers√£o TX2 para XML
- `Assinado=0`: XML sem assinatura digital
- `Url=1`: Retorna URL para download

### **3. Convers√£o B√°sica (Apenas Convers√£o)**

```bash
curl -X POST "https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/exportaxml" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -H "Authorization: Basic YWRtaW46MTIzbXVkYXI=" \
  -d "Grupo=GRUPO_EMPRESA&CNPJ=12345678000199&Converter=1" \
  --data-binary @arquivo.txt
```

**Par√¢metros**:
- `Converter=1`: Ativa a convers√£o TX2 para XML
- `Assinado` e `Url`: Usam valores padr√£o

## Respostas da API

### **Resposta de Sucesso - Conte√∫do XML (Url=0)**

```xml
<CTeOS versao="3.00" xmlns="http://www.portalfiscal.inf.br/cte">
    <infCte Id="CTe35211223856927000123670730000000051100000270" versao="3.00">
        <ide>
            <cUF>35</cUF>
            <cCT>000000005</cCT>
            <CFOP>5353</CFOP>
            <natOp>PRESTACAO DE SERVICOS DE TRANSPORTE</natOp>
            <mod>57</mod>
            <serie>1</serie>
            <nCT>000000270</nCT>
            <dhEmi>2021-11-22T10:00:00-03:00</dhEmi>
            <tpImp>1</tpImp>
            <tpEmis>1</tpEmis>
            <tpCTe>0</tpCTe>
            <procEmi>0</procEmi>
            <verProc>1.0</verProc>
            <cMunEnv>3550308</cMunEnv>
            <xMunEnv>SAO PAULO</xMunEnv>
            <UFEnv>SP</UFEnv>
            <modal>01</modal>
            <tpServ>0</tpServ>
        </ide>
        <rem>
            <CNPJ>12345678000199</CNPJ>
            <IE>123456789</IE>
            <xNome>TRANSPORTADORA EXEMPLO LTDA</xNome>
            <enderReme>
                <xLgr>Rua das Flores</xLgr>
                <nro>123</nro>
                <xBairro>Centro</xBairro>
                <xMun>S√£o Paulo</xMun>
                <CEP>01234-567</CEP>
                <UF>SP</UF>
            </enderReme>
        </rem>
        <dest>
            <CNPJ>98765432000188</CNPJ>
            <xNome>CLIENTE EXEMPLO LTDA</xNome>
            <enderDest>
                <xLgr>Av. Paulista</xLgr>
                <nro>1000</nro>
                <xBairro>Bela Vista</xBairro>
                <xMun>S√£o Paulo</xMun>
                <CEP>01310-100</CEP>
                <UF>SP</UF>
            </enderDest>
        </dest>
        <vPrest>
            <vTPrest>190.00</vTPrest>
            <vRec>190.00</vRec>
            <Comp>
                <xNome>Valor do Frete</xNome>
                <vComp>150.00</vComp>
            </Comp>
            <Comp>
                <xNome>Seguro</xNome>
                <vComp>25.00</vComp>
            </Comp>
            <Comp>
                <xNome>Despesas Acess√≥rias</xNome>
                <vComp>15.00</vComp>
            </Comp>
        </vPrest>
        <imp>
            <ICMS>
                <ICMS00>
                    <CST>00</CST>
                    <vBC>190.00</vBC>
                    <pICMS>18.00</pICMS>
                    <vICMS>34.20</vICMS>
                </ICMS00>
            </ICMS>
        </imp>
        <infDoc>
            <infNFe>
                <chNFe>41150408187168000160576660000006671000000012</chNFe>
            </infNFe>
        </infDoc>
        <tot>
            <qCTe>1</qCTe>
            <vCarga>50000.00</vCarga>
            <cUnid>01</cUnid>
            <qCarga>5000.000</qCarga>
        </tot>
    </infCte>
</CTeOS>
```

### **Resposta de Sucesso - URL Download (Url=1)**

```
http://managersaashom.tecnospeed.com.br:7071/ManagerAPIWeb/download/ManagerCTeOS/43170704086596000145578460000000011000000009.xml
```

### **Resposta de Erro**

```
EXCEPTION,EspdAPIWebServerErrorException,Tipo: deve ser informado
```

## Implementa√ß√£o em Diferentes Linguagens

### **JavaScript/Node.js**

```javascript
const converterTX2ParaXML = async (arquivoTX2, params) => {
  const formData = new FormData();
  formData.append('Grupo', params.grupo);
  formData.append('CNPJ', params.cnpj);
  formData.append('Arquivo', arquivoTX2);
  formData.append('Converter', params.converter);
  formData.append('Assinado', params.assinado || 0);
  formData.append('Url', params.url || 0);
  
  try {
    const response = await fetch('https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/exportaxml', {
      method: 'POST',
      headers: {
        'Authorization': 'Basic YWRtaW46MTIzbXVkYXI='
      },
      body: formData
    });
    
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    
    const resultado = await response.text();
    
    if (params.url === 1) {
      // Retorna URL para download
      return resultado;
    } else {
      // Retorna conte√∫do do XML
      return resultado;
    }
    
  } catch (error) {
    console.error('Erro na convers√£o:', error);
    throw error;
  }
};

// Exemplo de uso
const converterArquivo = async () => {
  try {
    // L√™ o arquivo TX2
    const arquivoTX2 = await fetch('arquivo.txt').then(res => res.blob());
    
    const resultado = await converterTX2ParaXML(arquivoTX2, {
      grupo: 'GRUPO_EMPRESA',
      cnpj: '12345678000199',
      converter: 1,
      assinado: 1,
      url: 0
    });
    
    console.log('XML convertido:', resultado);
    
    // Salva o XML em arquivo
    const blob = new Blob([resultado], { type: 'application/xml' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'cte_os.xml';
    a.click();
    
  } catch (error) {
    console.error('Erro na convers√£o:', error);
  }
};
```

### **Python**

```python
import requests
import os

def converter_tx2_para_xml(arquivo_tx2_path, params):
    """
    Converte arquivo TX2 para XML
    
    Args:
        arquivo_tx2_path (str): Caminho para o arquivo TX2
        params (dict): Par√¢metros da convers√£o
    
    Returns:
        str: XML convertido ou URL para download
    """
    url = "https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/exportaxml"
    
    headers = {
        'Authorization': 'Basic YWRtaW46MTIzbXVkYXI='
    }
    
    # L√™ o arquivo TX2
    with open(arquivo_tx2_path, 'rb') as f:
        arquivo_tx2 = f.read()
    
    files = {
        'Arquivo': ('arquivo.txt', arquivo_tx2, 'text/plain')
    }
    
    data = {
        'Grupo': params['grupo'],
        'CNPJ': params['cnpj'],
        'Converter': params['converter'],
        'Assinado': params.get('assinado', 0),
        'Url': params.get('url', 0)
    }
    
    try:
        response = requests.post(url, headers=headers, files=files, data=data)
        response.raise_for_status()
        
        resultado = response.text
        
        if params.get('url') == 1:
            # Retorna URL para download
            return resultado
        else:
            # Retorna conte√∫do do XML
            return resultado
            
    except requests.exceptions.RequestException as e:
        print(f"Erro na convers√£o: {e}")
        raise

def salvar_xml(xml_content, nome_arquivo):
    """
    Salva o XML em arquivo
    
    Args:
        xml_content (str): Conte√∫do do XML
        nome_arquivo (str): Nome do arquivo para salvar
    """
    with open(nome_arquivo, 'w', encoding='utf-8') as f:
        f.write(xml_content)
    print(f"XML salvo em: {nome_arquivo}")

# Exemplo de uso
if __name__ == "__main__":
    try:
        # Converte TX2 para XML
        resultado = converter_tx2_para_xml('arquivo.txt', {
            'grupo': 'GRUPO_EMPRESA',
            'cnpj': '12345678000199',
            'converter': 1,
            'assinado': 1,
            'url': 0
        })
        
        # Salva o XML
        salvar_xml(resultado, 'cte_os.xml')
        
        print("Convers√£o realizada com sucesso!")
        
    except Exception as e:
        print(f"Erro: {e}")
```

### **PHP**

```php
<?php

class CTeOSConverter {
    private $baseUrl = 'https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/exportaxml';
    private $authHeader = 'Basic YWRtaW46MTIzbXVkYXI=';
    
    /**
     * Converte arquivo TX2 para XML
     * 
     * @param string $arquivoTX2Path Caminho para o arquivo TX2
     * @param array $params Par√¢metros da convers√£o
     * @return string XML convertido ou URL para download
     * @throws Exception
     */
    public function converterTX2ParaXML($arquivoTX2Path, $params) {
        if (!file_exists($arquivoTX2Path)) {
            throw new Exception("Arquivo TX2 n√£o encontrado: {$arquivoTX2Path}");
        }
        
        // L√™ o arquivo TX2
        $arquivoTX2 = file_get_contents($arquivoTX2Path);
        
        // Cria arquivo tempor√°rio
        $tempFile = tempnam(sys_get_temp_dir(), 'tx2_');
        file_put_contents($tempFile, $arquivoTX2);
        
        $postData = [
            'Grupo' => $params['grupo'],
            'CNPJ' => $params['cnpj'],
            'Converter' => $params['converter'],
            'Assinado' => $params['assinado'] ?? 0,
            'Url' => $params['url'] ?? 0,
            'Arquivo' => new CURLFile($tempFile, 'text/plain', 'arquivo.txt')
        ];
        
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $this->baseUrl);
        curl_setopt($ch, CURLOPT_POST, true);
        curl_setopt($ch, CURLOPT_POSTFIELDS, $postData);
        curl_setopt($ch, CURLOPT_HTTPHEADER, [
            'Authorization: ' . $this->authHeader
        ]);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($ch, CURLOPT_TIMEOUT, 60);
        
        $response = curl_exec($ch);
        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
        $error = curl_error($ch);
        curl_close($ch);
        
        // Remove arquivo tempor√°rio
        unlink($tempFile);
        
        if ($error) {
            throw new Exception("Erro cURL: {$error}");
        }
        
        if ($httpCode !== 200) {
            throw new Exception("Erro HTTP: {$httpCode} - {$response}");
        }
        
        return $response;
    }
    
    /**
     * Salva XML em arquivo
     * 
     * @param string $xmlContent Conte√∫do do XML
     * @param string $nomeArquivo Nome do arquivo para salvar
     * @return bool
     */
    public function salvarXML($xmlContent, $nomeArquivo) {
        try {
            $bytes = file_put_contents($nomeArquivo, $xmlContent);
            return $bytes !== false;
        } catch (Exception $e) {
            throw new Exception("Erro ao salvar XML: " . $e->getMessage());
        }
    }
    
    /**
     * Valida se o XML √© v√°lido
     * 
     * @param string $xmlContent Conte√∫do do XML
     * @return bool
     */
    public function validarXML($xmlContent) {
        libxml_use_internal_errors(true);
        $xml = simplexml_load_string($xmlContent);
        $errors = libxml_get_errors();
        libxml_clear_errors();
        
        return $xml !== false && empty($errors);
    }
}

// Exemplo de uso
try {
    $converter = new CTeOSConverter();
    
    // Converte TX2 para XML
    $resultado = $converter->converterTX2ParaXML('arquivo.txt', [
        'grupo' => 'GRUPO_EMPRESA',
        'cnpj' => '12345678000199',
        'converter' => 1,
        'assinado' => 1,
        'url' => 0
    ]);
    
    // Valida o XML
    if ($converter->validarXML($resultado)) {
        echo "XML v√°lido!\n";
        
        // Salva o XML
        if ($converter->salvarXML($resultado, 'cte_os.xml')) {
            echo "XML salvo com sucesso!\n";
        }
    } else {
        echo "XML inv√°lido!\n";
    }
    
} catch (Exception $e) {
    echo "Erro: " . $e->getMessage() . "\n";
}
?>
```

## Tratamento de Erros

### **Erros Comuns**

| C√≥digo de Erro | Descri√ß√£o | Solu√ß√£o |
|----------------|-----------|---------|
| `EXCEPTION,EspdAPIWebServerErrorException,Tipo: deve ser informado` | Campo obrigat√≥rio n√£o informado | Verificar se todos os campos obrigat√≥rios est√£o preenchidos |
| `EXCEPTION,EspdAPIWebServerErrorException,Arquivo inv√°lido` | Arquivo TX2 malformado | Verificar formato e estrutura do arquivo TX2 |
| `EXCEPTION,EspdAPIWebServerErrorException,CNPJ inv√°lido` | CNPJ incorreto | Verificar formato e validade do CNPJ |
| `EXCEPTION,EspdAPIWebServerErrorException,Grupo n√£o encontrado` | Grupo inexistente | Verificar nome do grupo configurado no SaaS |

### **Valida√ß√µes Recomendadas**

#### **Antes da Convers√£o**
- Verificar se o arquivo TX2 existe e √© leg√≠vel
- Validar formato dos campos obrigat√≥rios
- Confirmar se o grupo e CNPJ est√£o corretos
- Verificar se o certificado digital est√° v√°lido (para assinatura)

#### **Ap√≥s a Convers√£o**
- Validar se o XML retornado √© v√°lido
- Verificar se todos os campos foram convertidos corretamente
- Confirmar se a assinatura digital foi aplicada (quando solicitado)
- Testar se o XML pode ser processado por sistemas externos

## Casos de Uso

### **1. Convers√£o para Valida√ß√£o**
- Converter TX2 para XML sem assinatura
- Validar estrutura e conte√∫do
- Corrigir erros antes da emiss√£o final

### **2. Convers√£o para Emiss√£o**
- Converter TX2 para XML com assinatura
- Usar XML assinado para emiss√£o na SEFAZ
- Garantir conformidade legal

### **3. Convers√£o para Integra√ß√£o**
- Converter arquivos TX2 de sistemas legados
- Padronizar formato para sistemas modernos
- Facilitar migra√ß√£o de dados

### **4. Convers√£o para Backup**
- Manter c√≥pia XML de documentos TX2
- Facilitar auditoria e consultas
- Preservar hist√≥rico de documentos

## Limita√ß√µes e Considera√ß√µes

### **Limita√ß√µes T√©cnicas**
- **Tamanho do arquivo**: Arquivos TX2 muito grandes podem causar timeout
- **Formato**: Apenas arquivos TX2 s√£o suportados
- **Codifica√ß√£o**: Recomenda-se usar UTF-8 para caracteres especiais
- **Certificado**: Assinatura digital requer certificado v√°lido

### **Considera√ß√µes de Performance**
- **Tempo de resposta**: Convers√£o pode levar alguns segundos
- **Concorr√™ncia**: M√∫ltiplas convers√µes simult√¢neas podem ser limitadas
- **Cache**: Resultados n√£o s√£o cacheados automaticamente

### **Seguran√ßa**
- **Autentica√ß√£o**: Sempre use credenciais v√°lidas
- **HTTPS**: Todas as comunica√ß√µes s√£o criptografadas
- **Valida√ß√£o**: Sempre valide XMLs retornados
- **Logs**: Mantenha logs de todas as convers√µes

## Pr√≥ximos Passos

<CardGroup cols={2}>
  <Card
    title="Endpoints de Emiss√£o"
    href="/api/endpoints/emission"
    icon="rocket"
  >
    Aprenda a emitir documentos
  </Card>
  <Card
    title="Consulta Avan√ßada"
    href="/api/endpoints/consultation"
    icon="search"
  >
    Consulte documentos existentes
  </Card>
  <Card
    title="Modelos de Dados"
    href="/api/models/request"
    icon="database"
  >
    Estrutura dos dados de entrada
  </Card>
  <Card
    title="Suporte"
    href="mailto:suporte@managersaas.com"
    icon="message-circle"
  >
    Entre em contato conosco
  </Card>
</CardGroup>

---

üîÑ **Convers√£o Simples**: Transforme arquivos TX2 em XML v√°lido para CT-e OS com facilidade. Para d√∫vidas sobre a convers√£o ou formato TX2, consulte nossa equipe de suporte. 