---
title: 'Descarte de CT-e OS'
description: 'Descarta CT-e OS rejeitados ou registrados para reutilizaÃ§Ã£o da numeraÃ§Ã£o'
---

# Descarte de CT-e OS

A rota de descarte permite invalidar um CT-e OS que foi rejeitado pela SEFAZ ou registrado, liberando a numeraÃ§Ã£o para ser reutilizada em uma nova emissÃ£o corrigida.

## Quando Usar o Descarte

### **SituaÃ§Ãµes que Permitem Descarte**

| SituaÃ§Ã£o | DescriÃ§Ã£o | Permite Descarte |
|----------|-----------|------------------|
| **REJEITADA** | CT-e OS rejeitado pela SEFAZ | âœ… **Sim** |
| **REGISTRADA** | CT-e OS registrado mas nÃ£o autorizado | âœ… **Sim** |
| **INUTILIZADA** | CT-e OS inutilizado | âœ… **Sim** |
| **IMPORTADA (NÃ£o autorizada)** | CT-e OS importado sem autorizaÃ§Ã£o | âœ… **Sim** |

### **SituaÃ§Ãµes que NÃƒO Permitem Descarte**

| SituaÃ§Ã£o | DescriÃ§Ã£o | Permite Descarte |
|----------|-----------|------------------|
| **AUTORIZADA** | CT-e OS autorizado pela SEFAZ | âŒ **NÃ£o** |
| **CANCELADA** | CT-e OS cancelado | âŒ **NÃ£o** |
| **DENEGADA** | CT-e OS denegado pela SEFAZ | âŒ **NÃ£o** |

## Endpoint de Descarte

```http
POST https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/descarta
```

## AutenticaÃ§Ã£o

### **Headers ObrigatÃ³rios**

```http
Content-Type: application/x-www-form-urlencoded
Authorization: Basic YWRtaW46MTIzbXVkYXI=
```

<Note>
ğŸ” **Importante**: As credenciais de autenticaÃ§Ã£o sÃ£o as mesmas utilizadas para login como administrador no grupo do SaaS.
</Note>

## ParÃ¢metros da RequisiÃ§Ã£o

### **ParÃ¢metros ObrigatÃ³rios**

| ParÃ¢metro | Tipo | DescriÃ§Ã£o | Exemplo |
|-----------|------|-----------|---------|
| `Grupo` | string | Nome do grupo configurado no SaaS | `GRUPO_EMPRESA` |
| `CNPJ` | string | CNPJ vinculado ao grupo (apenas nÃºmeros) | `12345678000199` |
| `ChaveNota` | string | Chave do CT-e OS (44 dÃ­gitos) | `41150408187168000160576660000006671000000012` |
| `NumeroLote` | string | NÃºmero do lote do CT-e OS | `LOTE001` |

### **Formato da Chave do CT-e OS**

A chave do CT-e OS Ã© composta por 44 dÃ­gitos com a seguinte estrutura:

```
41 15 04 08 187 168 000 123 67 07 300 000 000 511 000 002 70
â”‚  â”‚  â”‚  â”‚  â”‚   â”‚   â”‚   â”‚   â”‚  â”‚  â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  â”‚   â”‚   â”‚   â”‚   â”‚  â”‚  â”‚   â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€ NÃºmero sequencial
â”‚  â”‚  â”‚  â”‚  â”‚   â”‚   â”‚   â”‚   â”‚  â”‚  â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€â”€â”€â”€ SÃ©rie
â”‚  â”‚  â”‚  â”‚  â”‚   â”‚   â”‚   â”‚   â”‚  â”‚  â”‚   â”‚   â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€ CÃ³digo do municÃ­pio
â”‚  â”‚  â”‚  â”‚  â”‚   â”‚   â”‚   â”‚   â”‚  â”‚  â”‚   â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Ano/MÃªs de emissÃ£o
â”‚  â”‚  â”‚  â”‚  â”‚   â”‚   â”‚   â”‚   â”‚  â”‚  â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ CÃ³digo do CT-e
â”‚  â”‚  â”‚  â”‚  â”‚   â”‚   â”‚   â”‚   â”‚  â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ CÃ³digo da UF
â”‚  â”‚  â”‚  â”‚  â”‚   â”‚   â”‚   â”‚   â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Modelo do documento
â”‚  â”‚  â”‚  â”‚  â”‚   â”‚   â”‚   â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ CÃ³digo da UF
â”‚  â”‚  â”‚  â”‚  â”‚   â”‚   â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ CÃ³digo do municÃ­pio
â”‚  â”‚  â”‚  â”‚  â”‚   â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Ano/MÃªs de emissÃ£o
â”‚  â”‚  â”‚  â”‚  â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ CÃ³digo do CT-e
â”‚  â”‚  â”‚  â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ CÃ³digo da UF
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ CÃ³digo do municÃ­pio
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Ano/MÃªs de emissÃ£o
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ CÃ³digo do CT-e
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ CÃ³digo da UF
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ CÃ³digo do municÃ­pio
```

## Exemplos de RequisiÃ§Ã£o

### **1. Descarte de CT-e OS Rejeitado**

```bash
curl -X POST "https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/descarta" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -H "Authorization: Basic YWRtaW46MTIzbXVkYXI=" \
  -d "Grupo=GRUPO_EMPRESA&CNPJ=12345678000199&ChaveNota=41150408187168000160576660000006671000000012&NumeroLote=LOTE001"
```

### **2. Descarte de CT-e OS Registrado**

```bash
curl -X POST "https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/descarta" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -H "Authorization: Basic YWRtaW46MTIzbXVkYXI=" \
  -d "Grupo=GRUPO_EMPRESA&CNPJ=12345678000199&ChaveNota=41150408187168000160576660000006671000000013&NumeroLote=LOTE002"
```

### **3. Descarte de CT-e OS Inutilizado**

```bash
curl -X POST "https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/descarta" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -H "Authorization: Basic YWRtaW46MTIzbXVkYXI=" \
  -d "Grupo=GRUPO_EMPRESA&CNPJ=12345678000199&ChaveNota=41150408187168000160576660000006671000000014&NumeroLote=LOTE003"
```

## Respostas da API

### **Resposta de Sucesso**

```
OK, OperaÃ§Ã£o realizada com sucesso
```

**Status HTTP**: `200 OK`

### **Resposta de Erro**

```
EXCEPTION,EspdCheckParamsException,Somente CTe-OS REJEITADA\delimiter INUTILIZADA\delimiter REGISTRADA ou IMPORTADA(NÃ£o autorizada) pode ser descartada.
```

**Status HTTP**: `400 Bad Request`

### **Outros Erros PossÃ­veis**

| Erro | DescriÃ§Ã£o | SoluÃ§Ã£o |
|------|-----------|---------|
| `EXCEPTION,EspdCheckParamsException,Chave invÃ¡lida` | Chave do CT-e OS incorreta | Verificar formato da chave (44 dÃ­gitos) |
| `EXCEPTION,EspdCheckParamsException,CT-e OS nÃ£o encontrado` | CT-e OS inexistente | Verificar se a chave estÃ¡ correta |
| `EXCEPTION,EspdCheckParamsException,CNPJ invÃ¡lido` | CNPJ incorreto | Verificar formato e validade do CNPJ |
| `EXCEPTION,EspdCheckParamsException,Grupo nÃ£o encontrado` | Grupo inexistente | Verificar nome do grupo configurado |

## ImplementaÃ§Ã£o em Diferentes Linguagens

### **JavaScript/Node.js**

```javascript
class CTeOSDisposal {
  constructor(baseUrl, authToken) {
    this.baseUrl = baseUrl;
    this.authToken = authToken;
  }
  
  /**
   * Descarta um CT-e OS
   * @param {Object} params ParÃ¢metros do descarte
   * @returns {Promise<Object>} Resultado da operaÃ§Ã£o
   */
  async descartar(params) {
    const formData = new URLSearchParams();
    formData.append('Grupo', params.grupo);
    formData.append('CNPJ', params.cnpj);
    formData.append('ChaveNota', params.chaveNota);
    formData.append('NumeroLote', params.numeroLote);
    
    try {
      const response = await fetch(`${this.baseUrl}/cteos/descarta`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded',
          'Authorization': `Basic ${this.authToken}`
        },
        body: formData
      });
      
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      
      const resultado = await response.text();
      
      if (resultado.includes('OK, OperaÃ§Ã£o realizada com sucesso')) {
        return {
          success: true,
          message: resultado,
          status: 'DESCARTADO'
        };
      } else {
        return {
          success: false,
          error: resultado,
          status: 'ERRO'
        };
      }
      
    } catch (error) {
      console.error('Erro no descarte:', error);
      throw error;
    }
  }
  
  /**
   * Valida se o CT-e OS pode ser descartado
   * @param {string} chaveNota Chave do CT-e OS
   * @returns {Promise<boolean>} True se pode ser descartado
   */
  async podeSerDescartado(chaveNota) {
    // Primeiro consulta o status do CT-e OS
    try {
      const status = await this.consultarStatus(chaveNota);
      const situacoesPermitidas = ['REJEITADA', 'REGISTRADA', 'INUTILIZADA'];
      return situacoesPermitidas.includes(status.situacao);
    } catch (error) {
      console.error('Erro ao verificar status:', error);
      return false;
    }
  }
  
  /**
   * Consulta o status de um CT-e OS
   * @param {string} chaveNota Chave do CT-e OS
   * @returns {Promise<Object>} Status do CT-e OS
   */
  async consultarStatus(chaveNota) {
    // Implementar consulta de status
    // Esta Ã© uma implementaÃ§Ã£o de exemplo
    return { situacao: 'REJEITADA' };
  }
}

// Exemplo de uso
const disposal = new CTeOSDisposal(
  'https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb',
  'YWRtaW46MTIzbXVkYXI='
);

const realizarDescarte = async () => {
  try {
    // Verifica se pode ser descartado
    const podeDescarte = await disposal.podeSerDescartado('41150408187168000160576660000006671000000012');
    
    if (!podeDescarte) {
      console.log('CT-e OS nÃ£o pode ser descartado');
      return;
    }
    
    // Realiza o descarte
    const resultado = await disposal.descartar({
      grupo: 'GRUPO_EMPRESA',
      cnpj: '12345678000199',
      chaveNota: '41150408187168000160576660000006671000000012',
      numeroLote: 'LOTE001'
    });
    
    if (resultado.success) {
      console.log('Descarte realizado com sucesso:', resultado.message);
    } else {
      console.error('Erro no descarte:', resultado.error);
    }
    
  } catch (error) {
    console.error('Erro:', error);
  }
};

realizarDescarte();
```

### **Python**

```python
import requests
from typing import Dict, Optional
from dataclasses import dataclass

@dataclass
class CTeOSDisposalResult:
    success: bool
    message: str
    status: str
    error: Optional[str] = None

class CTeOSDisposal:
    def __init__(self, base_url: str, auth_token: str):
        self.base_url = base_url
        self.auth_token = auth_token
        self.session = requests.Session()
        self.session.headers.update({
            'Authorization': f'Basic {auth_token}'
        })
    
    def descartar(self, params: Dict) -> CTeOSDisposalResult:
        """
        Descarta um CT-e OS
        
        Args:
            params: DicionÃ¡rio com parÃ¢metros do descarte
            
        Returns:
            CTeOSDisposalResult: Resultado da operaÃ§Ã£o
        """
        url = f"{self.base_url}/cteos/descarta"
        
        data = {
            'Grupo': params['grupo'],
            'CNPJ': params['cnpj'],
            'ChaveNota': params['chave_nota'],
            'NumeroLote': params['numero_lote']
        }
        
        try:
            response = self.session.post(url, data=data)
            response.raise_for_status()
            
            resultado = response.text
            
            if 'OK, OperaÃ§Ã£o realizada com sucesso' in resultado:
                return CTeOSDisposalResult(
                    success=True,
                    message=resultado,
                    status='DESCARTADO'
                )
            else:
                return CTeOSDisposalResult(
                    success=False,
                    message='',
                    status='ERRO',
                    error=resultado
                )
                
        except requests.exceptions.RequestException as e:
            return CTeOSDisposalResult(
                success=False,
                message='',
                status='ERRO',
                error=str(e)
            )
    
    def pode_ser_descartado(self, chave_nota: str) -> bool:
        """
        Verifica se o CT-e OS pode ser descartado
        
        Args:
            chave_nota: Chave do CT-e OS
            
        Returns:
            bool: True se pode ser descartado
        """
        try:
            status = self.consultar_status(chave_nota)
            situacoes_permitidas = ['REJEITADA', 'REGISTRADA', 'INUTILIZADA']
            return status.get('situacao') in situacoes_permitidas
        except Exception:
            return False
    
    def consultar_status(self, chave_nota: str) -> Dict:
        """
        Consulta o status de um CT-e OS
        
        Args:
            chave_nota: Chave do CT-e OS
            
        Returns:
            Dict: Status do CT-e OS
        """
        # Implementar consulta de status
        # Esta Ã© uma implementaÃ§Ã£o de exemplo
        return {'situacao': 'REJEITADA'}
    
    def validar_chave(self, chave_nota: str) -> bool:
        """
        Valida o formato da chave do CT-e OS
        
        Args:
            chave_nota: Chave do CT-e OS
            
        Returns:
            bool: True se a chave Ã© vÃ¡lida
        """
        if not chave_nota or len(chave_nota) != 44:
            return False
        
        # Verifica se contÃ©m apenas dÃ­gitos
        return chave_nota.isdigit()

# Exemplo de uso
def main():
    disposal = CTeOSDisposal(
        'https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb',
        'YWRtaW46MTIzbXVkYXI='
    )
    
    # Valida a chave
    chave_nota = '41150408187168000160576660000006671000000012'
    if not disposal.validar_chave(chave_nota):
        print('Chave invÃ¡lida')
        return
    
    # Verifica se pode ser descartado
    if not disposal.pode_ser_descartado(chave_nota):
        print('CT-e OS nÃ£o pode ser descartado')
        return
    
    # Realiza o descarte
    resultado = disposal.descartar({
        'grupo': 'GRUPO_EMPRESA',
        'cnpj': '12345678000199',
        'chave_nota': chave_nota,
        'numero_lote': 'LOTE001'
    })
    
    if resultado.success:
        print(f'Descarte realizado com sucesso: {resultado.message}')
    else:
        print(f'Erro no descarte: {resultado.error}')

if __name__ == "__main__":
    main()
```

### **PHP**

```php
<?php

class CTeOSDisposal {
    private $baseUrl;
    private $authToken;
    private $httpClient;
    
    public function __construct($baseUrl, $authToken) {
        $this->baseUrl = $baseUrl;
        $this->authToken = $authToken;
        $this->httpClient = new HttpClient();
    }
    
    /**
     * Descarta um CT-e OS
     * 
     * @param array $params ParÃ¢metros do descarte
     * @return array Resultado da operaÃ§Ã£o
     * @throws Exception
     */
    public function descartar($params) {
        $url = $this->baseUrl . '/cteos/descarta';
        
        $headers = [
            'Content-Type: application/x-www-form-urlencoded',
            'Authorization: Basic ' . $this->authToken
        ];
        
        $postData = http_build_query([
            'Grupo' => $params['grupo'],
            'CNPJ' => $params['cnpj'],
            'ChaveNota' => $params['chaveNota'],
            'NumeroLote' => $params['numeroLote']
        ]);
        
        try {
            $response = $this->httpClient->post($url, $postData, $headers);
            
            if (strpos($response, 'OK, OperaÃ§Ã£o realizada com sucesso') !== false) {
                return [
                    'success' => true,
                    'message' => $response,
                    'status' => 'DESCARTADO'
                ];
            } else {
                return [
                    'success' => false,
                    'message' => '',
                    'status' => 'ERRO',
                    'error' => $response
                ];
            }
            
        } catch (Exception $e) {
            return [
                'success' => false,
                'message' => '',
                'status' => 'ERRO',
                'error' => $e->getMessage()
            ];
        }
    }
    
    /**
     * Verifica se o CT-e OS pode ser descartado
     * 
     * @param string $chaveNota Chave do CT-e OS
     * @return bool True se pode ser descartado
     */
    public function podeSerDescartado($chaveNota) {
        try {
            $status = $this->consultarStatus($chaveNota);
            $situacoesPermitidas = ['REJEITADA', 'REGISTRADA', 'INUTILIZADA'];
            return in_array($status['situacao'], $situacoesPermitidas);
        } catch (Exception $e) {
            return false;
        }
    }
    
    /**
     * Consulta o status de um CT-e OS
     * 
     * @param string $chaveNota Chave do CT-e OS
     * @return array Status do CT-e OS
     */
    public function consultarStatus($chaveNota) {
        // Implementar consulta de status
        // Esta Ã© uma implementaÃ§Ã£o de exemplo
        return ['situacao' => 'REJEITADA'];
    }
    
    /**
     * Valida o formato da chave do CT-e OS
     * 
     * @param string $chaveNota Chave do CT-e OS
     * @return bool True se a chave Ã© vÃ¡lida
     */
    public function validarChave($chaveNota) {
        if (empty($chaveNota) || strlen($chaveNota) !== 44) {
            return false;
        }
        
        // Verifica se contÃ©m apenas dÃ­gitos
        return ctype_digit($chaveNota);
    }
    
    /**
     * Realiza o descarte com validaÃ§Ãµes
     * 
     * @param array $params ParÃ¢metros do descarte
     * @return array Resultado da operaÃ§Ã£o
     */
    public function descartarComValidacao($params) {
        // Valida a chave
        if (!$this->validarChave($params['chaveNota'])) {
            return [
                'success' => false,
                'message' => '',
                'status' => 'ERRO',
                'error' => 'Chave invÃ¡lida'
            ];
        }
        
        // Verifica se pode ser descartado
        if (!$this->podeSerDescartado($params['chaveNota'])) {
            return [
                'success' => false,
                'message' => '',
                'status' => 'ERRO',
                'error' => 'CT-e OS nÃ£o pode ser descartado'
            ];
        }
        
        // Realiza o descarte
        return $this->descartar($params);
    }
}

class HttpClient {
    public function post($url, $data, $headers = []) {
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $url);
        curl_setopt($ch, CURLOPT_POST, true);
        curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
        curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($ch, CURLOPT_TIMEOUT, 60);
        
        $response = curl_exec($ch);
        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
        $error = curl_error($ch);
        curl_close($ch);
        
        if ($error) {
            throw new Exception("Erro cURL: {$error}");
        }
        
        if ($httpCode !== 200) {
            throw new Exception("Erro HTTP: {$httpCode}");
        }
        
        return $response;
    }
}

// Exemplo de uso
try {
    $disposal = new CTeOSDisposal(
        'https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb',
        'YWRtaW46MTIzbXVkYXI='
    );
    
    // Valida a chave
    $chaveNota = '41150408187168000160576660000006671000000012';
    if (!$disposal->validarChave($chaveNota)) {
        echo "Chave invÃ¡lida\n";
        exit;
    }
    
    // Verifica se pode ser descartado
    if (!$disposal->podeSerDescartado($chaveNota)) {
        echo "CT-e OS nÃ£o pode ser descartado\n";
        exit;
    }
    
    // Realiza o descarte com validaÃ§Ãµes
    $resultado = $disposal->descartarComValidacao([
        'grupo' => 'GRUPO_EMPRESA',
        'cnpj' => '12345678000199',
        'chaveNota' => $chaveNota,
        'numeroLote' => 'LOTE001'
    ]);
    
    if ($resultado['success']) {
        echo "Descarte realizado com sucesso: " . $resultado['message'] . "\n";
    } else {
        echo "Erro no descarte: " . $resultado['error'] . "\n";
    }
    
} catch (Exception $e) {
    echo "Erro: " . $e->getMessage() . "\n";
}
?>
```

## Fluxo de Descarte

### **1. VerificaÃ§Ã£o de Elegibilidade**

```mermaid
flowchart TD
    A[InÃ­cio] --> B[Consultar Status do CT-e OS]
    B --> C{Status Permitido?}
    C -->|Sim| D[Validar ParÃ¢metros]
    C -->|NÃ£o| E[Erro: NÃ£o pode ser descartado]
    D --> F{ParÃ¢metros VÃ¡lidos?}
    F -->|Sim| G[Executar Descarte]
    F -->|NÃ£o| H[Erro: ParÃ¢metros invÃ¡lidos]
    G --> I{Descarte Realizado?}
    I -->|Sim| J[Sucesso: NumeraÃ§Ã£o liberada]
    I -->|NÃ£o| K[Erro: Falha no descarte]
```

### **2. Processo de Descarte**

1. **ValidaÃ§Ã£o Inicial**
   - Verificar se o CT-e OS existe
   - Confirmar se o status permite descarte
   - Validar parÃ¢metros da requisiÃ§Ã£o

2. **ExecuÃ§Ã£o do Descarte**
   - Marcar CT-e OS como descartado
   - Liberar a numeraÃ§Ã£o para reutilizaÃ§Ã£o
   - Registrar log da operaÃ§Ã£o

3. **ConfirmaÃ§Ã£o**
   - Retornar mensagem de sucesso
   - Atualizar status no sistema

## Casos de Uso

### **1. CorreÃ§Ã£o de CT-e OS Rejeitado**
- CT-e OS rejeitado pela SEFAZ
- Necessidade de corrigir dados
- ReutilizaÃ§Ã£o da mesma numeraÃ§Ã£o

### **2. Cancelamento de CT-e OS Registrado**
- CT-e OS registrado mas nÃ£o autorizado
- MudanÃ§a de decisÃ£o sobre emissÃ£o
- LiberaÃ§Ã£o da numeraÃ§Ã£o

### **3. InutilizaÃ§Ã£o de CT-e OS**
- CT-e OS com problemas tÃ©cnicos
- Necessidade de reiniciar numeraÃ§Ã£o
- Limpeza do sistema

### **4. ImportaÃ§Ã£o de CT-e OS NÃ£o Autorizado**
- CT-e OS importado sem autorizaÃ§Ã£o
- Necessidade de revalidaÃ§Ã£o
- Processo de autorizaÃ§Ã£o manual

## Tratamento de Erros

### **Erros Comuns e SoluÃ§Ãµes**

| Erro | Causa | SoluÃ§Ã£o |
|------|-------|---------|
| **Chave invÃ¡lida** | Formato incorreto da chave | Verificar se tem 44 dÃ­gitos numÃ©ricos |
| **CT-e OS nÃ£o encontrado** | Chave inexistente | Confirmar se a chave estÃ¡ correta |
| **Status nÃ£o permite descarte** | CT-e OS autorizado/cancelado | Verificar status atual do documento |
| **CNPJ invÃ¡lido** | CNPJ incorreto | Verificar formato e validade do CNPJ |
| **Grupo nÃ£o encontrado** | Grupo inexistente | Confirmar nome do grupo configurado |

### **ValidaÃ§Ãµes Recomendadas**

#### **Antes do Descarte**
- âœ… Verificar se o CT-e OS existe
- âœ… Confirmar se o status permite descarte
- âœ… Validar formato da chave (44 dÃ­gitos)
- âœ… Confirmar se o grupo e CNPJ estÃ£o corretos

#### **ApÃ³s o Descarte**
- âœ… Confirmar mensagem de sucesso
- âœ… Verificar se a numeraÃ§Ã£o foi liberada
- âœ… Consultar status atualizado do CT-e OS
- âœ… Testar emissÃ£o com a numeraÃ§Ã£o liberada

## LimitaÃ§Ãµes e ConsideraÃ§Ãµes

### **LimitaÃ§Ãµes TÃ©cnicas**
- **Status Ãºnico**: Apenas CT-e OS com status especÃ­ficos podem ser descartados
- **Chave obrigatÃ³ria**: A chave de 44 dÃ­gitos Ã© obrigatÃ³ria
- **Lote obrigatÃ³rio**: NÃºmero do lote deve ser informado
- **AutenticaÃ§Ã£o**: Requer credenciais de administrador

### **ConsideraÃ§Ãµes de NegÃ³cio**
- **NumeraÃ§Ã£o sequencial**: Descarte libera a numeraÃ§Ã£o para reutilizaÃ§Ã£o
- **Auditoria**: Todas as operaÃ§Ãµes de descarte sÃ£o registradas
- **Conformidade**: Descarte deve seguir regras da SEFAZ
- **HistÃ³rico**: Manter registro de CT-e OS descartados

### **SeguranÃ§a**
- **AutenticaÃ§Ã£o**: Sempre use credenciais vÃ¡lidas
- **AutorizaÃ§Ã£o**: Apenas administradores podem descartar
- **Logs**: Todas as operaÃ§Ãµes sÃ£o registradas
- **ValidaÃ§Ã£o**: Sempre valide parÃ¢metros antes do descarte

## PrÃ³ximos Passos

<CardGroup cols={2}>
  <Card
    title="EmissÃ£o de CT-e OS"
    href="/api/endpoints/emission"
    icon="rocket"
  >
    Emita novos documentos
  </Card>
  <Card
    title="Consulta AvanÃ§ada"
    href="/api/endpoints/consultation"
    icon="search"
  >
    Consulte documentos existentes
  </Card>
  <Card
    title="ConversÃ£o TX2 para XML"
    href="/api/endpoints/conversion"
    icon="file-text"
  >
    Converta arquivos TX2
  </Card>
  <Card
    title="Suporte"
    href="mailto:suporte@managersaas.com"
    icon="message-circle"
  >
    Entre em contato conosco
  </Card>
</CardGroup>

---

ğŸ—‘ï¸ **Descarte Inteligente**: Libere numeraÃ§Ãµes de CT-e OS rejeitados ou registrados para reutilizaÃ§Ã£o. Para dÃºvidas sobre o processo de descarte ou situaÃ§Ãµes especÃ­ficas, consulte nossa equipe de suporte. 