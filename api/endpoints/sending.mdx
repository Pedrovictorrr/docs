---
title: 'Envio para SEFAZ'
description: 'Envia CT-e OS para a SEFAZ de forma s√≠ncrona para autoriza√ß√£o ou rejei√ß√£o'
---

# Envio de CT-e OS para SEFAZ

A rota de envio permite enviar um CT-e OS diretamente para a SEFAZ de forma s√≠ncrona, recebendo imediatamente a resposta de autoriza√ß√£o ou rejei√ß√£o. Esta √© a funcionalidade principal para emiss√£o de documentos fiscais eletr√¥nicos.

## Caracter√≠sticas do Envio

### **Comunica√ß√£o S√≠ncrona**
- ‚úÖ **Resposta imediata**: A API retorna diretamente a resposta da SEFAZ
- ‚úÖ **Status em tempo real**: Conhe√ßa imediatamente se foi autorizado ou rejeitado
- ‚úÖ **Sem polling**: N√£o √© necess√°rio consultar status posteriormente
- ‚úÖ **Processamento direto**: Valida√ß√£o e assinatura autom√°ticas

### **Tipos de Arquivo Suportados**
- **TX2**: Formato de texto estruturado (recomendado)
- **XML**: Arquivo XML j√° formatado e validado

## Endpoint de Envio

```http
POST https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/envia
```

## Autentica√ß√£o

### **Headers Obrigat√≥rios**

```http
Content-Type: application/x-www-form-urlencoded
Authorization: Basic YWRtaW46MTIzbXVkYXI=
```

<Note>
üîê **Importante**: As credenciais de autentica√ß√£o s√£o as mesmas utilizadas para login como administrador no grupo do SaaS.
</Note>

## Par√¢metros da Requisi√ß√£o

### **Par√¢metros Obrigat√≥rios**

| Par√¢metro | Tipo | Descri√ß√£o | Exemplo |
|-----------|------|-----------|---------|
| `Grupo` | string | Nome do grupo configurado no SaaS | `GRUPO_EMPRESA` |
| `CNPJ` | string | CNPJ do emitente (apenas n√∫meros) | `11111111111111` |
| `Arquivo` | file | Conte√∫do do arquivo TX2 ou XML | Conte√∫do bin√°rio |

## Formato TX2 para Envio

### **Estrutura B√°sica do TX2**

O arquivo TX2 √© um arquivo de texto estruturado com campos espec√≠ficos para cada elemento do CT-e OS:

```txt
formato=tx2
incluirCTeOS

# Identifica√ß√£o do CT-e OS
cUF_6=41
cCT_7=06021956
CFOP_8=5352
natOp_9=Aquisicao
mod_10=67
serie_11=2
nCT_12=489
dhEmi_13=2018-05-01T10:01:01-03:00
tpImp_14=1
tpEmis_15=1
cDV_16=8
tpAmb_17=2
tpCTe_18=0
procEmi_19=0
verProc_20=3.00

# Munic√≠pio e UF de envio
cMunEnv_21=4105805
xMunEnv_22=COLOMBO
UFEnv_23=PR

# Modal e tipo de servi√ßo
modal_24=01
tpServ_25=7

# Indicador de IE do tomador
indIEToma_26=1

# Munic√≠pios de in√≠cio e fim
cMunIni_27=4105805
xMunIni_28=COLOMBO
UFIni_29=PR
cMunFim_30=4105805
xMunFim_31=COLOMBO
UFFim_32=PR

# Dados do emitente
CNPJ_49=11111111111111
IE_50=9049880224
xNome_52=Nome LTDA
xFant_53=Nome LTDA
xLgr_55=Rua dos Programadores
nro_56=12
xBairro_58=Centro
cMun_59=4105805
xMun_60=COLOMBO
CEP_61=89233198
UF_62=PR

# Dados do tomador
CNPJ_65=11111111111111
IE_67=9049880224
xNome_68=Fulano
xFant_69=Fantasia Fulano
xLgr_72=Rua dos Programadores
nro_73=123
xBairro_75=Centro
cMun_76=4105805
xMun_77=COLOMBO
CEP_78=89233198
UF_79=PR
cPais_80=1058
xPais_81=BRASIL
email_82=fabianopassianoto@gmail.com

# Valores e impostos
vTPrest_84=1
vRec_85=1
CST_92=00
vBC_93=1
pICMS_94=7
vICMS_95=0.07
vINSS_129=0.10

# Descri√ß√£o do servi√ßo
xDescServ_133=Transporte de Passageiros
qCarga_135=30

# Vers√£o do modal
versaoModal_147=3.00

# Vers√£o do CT-e
versao_3=3.00
versao_1=3.00

# Comandos de finaliza√ß√£o
salvarCTeOS
```

### **Campos Obrigat√≥rios TX2**

| Campo | Descri√ß√£o | Exemplo |
|-------|-----------|---------|
| `formato` | Formato do arquivo | `tx2` |
| `incluirCTeOS` | Inicia a cria√ß√£o do CT-e OS | `incluirCTeOS` |
| `cUF_6` | C√≥digo da UF | `41` (Paran√°) |
| `cCT_7` | C√≥digo do CT-e | `06021956` |
| `CFOP_8` | C√≥digo fiscal de opera√ß√µes | `5352` |
| `natOp_9` | Natureza da opera√ß√£o | `Aquisicao` |
| `mod_10` | Modelo do documento | `67` |
| `serie_11` | S√©rie do documento | `2` |
| `nCT_12` | N√∫mero do CT-e | `489` |
| `dhEmi_13` | Data/hora de emiss√£o | `2018-05-01T10:01:01-03:00` |
| `tpAmb_17` | Tipo de ambiente | `2` (Homologa√ß√£o) |
| `tpCTe_18` | Tipo de CT-e | `0` (Normal) |
| `verProc_20` | Vers√£o do processo | `3.00` |
| `CNPJ_49` | CNPJ do emitente | `11111111111111` |
| `xNome_52` | Nome do emitente | `Nome LTDA` |
| `CNPJ_65` | CNPJ do tomador | `11111111111111` |
| `xNome_68` | Nome do tomador | `Fulano` |
| `vTPrest_84` | Valor total da presta√ß√£o | `1` |
| `salvarCTeOS` | Finaliza a cria√ß√£o | `salvarCTeOS` |

### **Campos Opcionais TX2**

| Campo | Descri√ß√£o | Exemplo |
|-------|-----------|---------|
| `tpImp_14` | Tipo de impress√£o | `1` |
| `tpEmis_15` | Tipo de emiss√£o | `1` |
| `cDV_16` | D√≠gito verificador | `8` |
| `procEmi_19` | Processo de emiss√£o | `0` |
| `indIEToma_26` | Indicador de IE do tomador | `1` |
| `xLgr_55` | Logradouro do emitente | `Rua dos Programadores` |
| `nro_56` | N√∫mero do endere√ßo | `12` |
| `xBairro_58` | Bairro | `Centro` |
| `CEP_61` | CEP | `89233198` |
| `email_82` | E-mail do tomador | `email@exemplo.com` |
| `xDescServ_133` | Descri√ß√£o do servi√ßo | `Transporte de Passageiros` |
| `qCarga_135` | Quantidade da carga | `30` |

## Exemplos de Requisi√ß√£o

### **1. Envio com Arquivo TX2**

```bash
curl -X POST "https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/envia" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -H "Authorization: Basic YWRtaW46MTIzbXVkYXI=" \
  -d "Grupo=GRUPO_EMPRESA&CNPJ=11111111111111" \
  --data-binary @arquivo.txt
```

### **2. Envio com Arquivo XML**

```bash
curl -X POST "https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb/cteos/envia" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -H "Authorization: Basic YWRtaW46MTIzbXVkYXI=" \
  -d "Grupo=GRUPO_EMPRESA&CNPJ=11111111111111" \
  --data-binary @cte_os.xml
```

## Respostas da API

### **Resposta de Sucesso**

```
12345678,42120605793827000113574580000000031123456786,100,Autorizado o uso do CTe-OS
```

**Formato da Resposta**:
`"N√∫mero do lote", "Chave do CTe-OS", "cStat (C√≥digo de status)", "Mensagem da SEFAZ"`

**Campos da Resposta**:
- **N√∫mero do lote**: Identificador √∫nico do lote enviado
- **Chave do CTe-OS**: Chave de acesso de 44 d√≠gitos
- **cStat**: C√≥digo de status da SEFAZ
- **Mensagem da SEFAZ**: Descri√ß√£o do status

### **C√≥digos de Status (cStat)**

| C√≥digo | Status | Descri√ß√£o |
|--------|--------|-----------|
| `100` | ‚úÖ **AUTORIZADA** | CT-e OS autorizado com sucesso |
| `101` | ‚úÖ **CANCELADA** | CT-e OS cancelado |
| `102` | ‚ùå **INUTILIZADA** | CT-e OS inutilizado |
| `103` | ‚ùå **DENEGADA** | CT-e OS denegado pela SEFAZ |
| `104` | ‚ùå **REJEITADA** | CT-e OS rejeitado pela SEFAZ |

### **Resposta de Erro**

```
EXCEPTION,EspdManCTeOSAssinarException,Problema ao assinar Nota(s). Exception: Falha ao Validar Lote para Envio. Erro: EspdSchemaValidationException O arquivo cont√©m 1 ou mais erros no de valida√ß√£o de esquema '5.00' viola a restri√ß√£o pattern de '3.00'. Falha da analise do atributo 'versao' com valor '5.00'
```

**Formato do Erro**:
`"Palavra Exception", "Classe da Exception", "Mensagem de Exception"`

### **Erros Comuns e Solu√ß√µes**

| Erro | Causa | Solu√ß√£o |
|------|-------|---------|
| **EspdSchemaValidationException** | Valida√ß√£o de esquema falhou | Verificar vers√£o e estrutura do XML |
| **EspdManCTeOSAssinarException** | Problema na assinatura | Verificar certificado digital |
| **EspdCheckParamsException** | Par√¢metros inv√°lidos | Verificar grupo, CNPJ e arquivo |
| **EspdFileNotFoundException** | Arquivo n√£o encontrado | Verificar caminho e permiss√µes |

## Implementa√ß√£o em Diferentes Linguagens

### **JavaScript/Node.js**

```javascript
class CTeOSSender {
  constructor(baseUrl, authToken) {
    this.baseUrl = baseUrl;
    this.authToken = authToken;
  }
  
  /**
   * Envia CT-e OS para a SEFAZ
   * @param {File|Blob} arquivo Arquivo TX2 ou XML
   * @param {Object} params Par√¢metros do envio
   * @returns {Promise<Object>} Resultado do envio
   */
  async enviar(arquivo, params) {
    const formData = new FormData();
    formData.append('Grupo', params.grupo);
    formData.append('CNPJ', params.cnpj);
    formData.append('Arquivo', arquivo);
    
    try {
      const response = await fetch(`${this.baseUrl}/cteos/envia`, {
        method: 'POST',
        headers: {
          'Authorization': `Basic ${this.authToken}`
        },
        body: formData
      });
      
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      
      const resultado = await response.text();
      
      // Verifica se √© uma resposta de sucesso ou erro
      if (resultado.includes('EXCEPTION')) {
        return { success: false, error: resultado };
      } else {
        // Parse da resposta de sucesso
        const [numeroLote, chave, cStat, mensagem] = resultado.split(',').map(s => s.trim());
        return {
          success: true,
          numeroLote,
          chave,
          cStat: parseInt(cStat),
          mensagem,
          raw: resultado,
          status: this.interpretarStatus(parseInt(cStat))
        };
      }
      
    } catch (error) {
      console.error('Erro no envio:', error);
      throw error;
    }
  }
  
  /**
   * Interpreta o c√≥digo de status da SEFAZ
   * @param {number} cStat C√≥digo de status
   * @returns {string} Descri√ß√£o do status
   */
  interpretarStatus(cStat) {
    const statusMap = {
      100: 'AUTORIZADA',
      101: 'CANCELADA',
      102: 'INUTILIZADA',
      103: 'DENEGADA',
      104: 'REJEITADA'
    };
    
    return statusMap[cStat] || 'DESCONHECIDO';
  }
  
  /**
   * Verifica se o CT-e OS foi autorizado
   * @param {Object} resultado Resultado do envio
   * @returns {boolean} True se foi autorizado
   */
  foiAutorizado(resultado) {
    return resultado.success && resultado.cStat === 100;
  }
  
  /**
   * Verifica se o CT-e OS foi rejeitado
   * @param {Object} resultado Resultado do envio
   * @returns {boolean} True se foi rejeitado
   */
  foiRejeitado(resultado) {
    return resultado.success && resultado.cStat === 104;
  }
}

// Exemplo de uso
const sender = new CTeOSSender(
  'https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb',
  'YWRtaW46MTIzbXVkYXI='
);

const enviarCTeOS = async () => {
  try {
    // L√™ o arquivo TX2
    const arquivo = await fetch('arquivo.txt').then(res => res.blob());
    
    const resultado = await sender.enviar(arquivo, {
      grupo: 'GRUPO_EMPRESA',
      cnpj: '11111111111111'
    });
    
    if (resultado.success) {
      console.log('CT-e OS enviado com sucesso!');
      console.log('Lote:', resultado.numeroLote);
      console.log('Chave:', resultado.chave);
      console.log('Status:', resultado.status);
      console.log('Mensagem:', resultado.mensagem);
      
      if (sender.foiAutorizado(resultado)) {
        console.log('üéâ CT-e OS autorizado pela SEFAZ!');
      } else if (sender.foiRejeitado(resultado)) {
        console.log('‚ùå CT-e OS rejeitado pela SEFAZ');
      }
    } else {
      console.error('Erro no envio:', resultado.error);
    }
    
  } catch (error) {
    console.error('Erro:', error);
  }
};

enviarCTeOS();
```

### **Python**

```python
import requests
from typing import Dict, Optional
from dataclasses import dataclass
from enum import Enum

class StatusCTe(Enum):
    AUTORIZADA = 100
    CANCELADA = 101
    INUTILIZADA = 102
    DENEGADA = 103
    REJEITADA = 104

@dataclass
class CTeOSResult:
    success: bool
    numero_lote: Optional[str] = None
    chave: Optional[str] = None
    c_stat: Optional[int] = None
    mensagem: Optional[str] = None
    status: Optional[str] = None
    error: Optional[str] = None
    raw: Optional[str] = None

class CTeOSSender:
    def __init__(self, base_url: str, auth_token: str):
        self.base_url = base_url
        self.auth_token = auth_token
        self.session = requests.Session()
        self.session.headers.update({
            'Authorization': f'Basic {auth_token}'
        })
    
    def enviar(self, arquivo_path: str, params: Dict) -> CTeOSResult:
        """
        Envia CT-e OS para a SEFAZ
        
        Args:
            arquivo_path: Caminho para o arquivo TX2 ou XML
            params: Dicion√°rio com par√¢metros do envio
            
        Returns:
            CTeOSResult: Resultado do envio
        """
        url = f"{self.base_url}/cteos/envia"
        
        # L√™ o arquivo
        try:
            with open(arquivo_path, 'rb') as f:
                arquivo = f.read()
        except FileNotFoundError:
            return CTeOSResult(
                success=False,
                error=f"Arquivo n√£o encontrado: {arquivo_path}"
            )
        
        files = {
            'Arquivo': ('arquivo.txt', arquivo, 'text/plain')
        }
        
        data = {
            'Grupo': params['grupo'],
            'CNPJ': params['cnpj']
        }
        
        try:
            response = self.session.post(url, files=files, data=data)
            response.raise_for_status()
            
            resultado = response.text
            
            # Verifica se √© uma resposta de sucesso ou erro
            if 'EXCEPTION' in resultado:
                return CTeOSResult(
                    success=False,
                    error=resultado
                )
            else:
                # Parse da resposta de sucesso
                partes = [part.strip() for part in resultado.split(',')]
                if len(partes) >= 4:
                    c_stat = int(partes[2])
                    return CTeOSResult(
                        success=True,
                        numero_lote=partes[0],
                        chave=partes[1],
                        c_stat=c_stat,
                        mensagem=partes[3],
                        status=self.interpretar_status(c_stat),
                        raw=resultado
                    )
                else:
                    return CTeOSResult(
                        success=False,
                        error='Formato de resposta inv√°lido'
                    )
                    
        except requests.exceptions.RequestException as e:
            return CTeOSResult(
                success=False,
                error=str(e)
            )
    
    def interpretar_status(self, c_stat: int) -> str:
        """
        Interpreta o c√≥digo de status da SEFAZ
        
        Args:
            c_stat: C√≥digo de status
            
        Returns:
            str: Descri√ß√£o do status
        """
        try:
            return StatusCTe(c_stat).name
        except ValueError:
            return 'DESCONHECIDO'
    
    def foi_autorizado(self, resultado: CTeOSResult) -> bool:
        """
        Verifica se o CT-e OS foi autorizado
        
        Args:
            resultado: Resultado do envio
            
        Returns:
            bool: True se foi autorizado
        """
        return resultado.success and resultado.c_stat == StatusCTe.AUTORIZADA.value
    
    def foi_rejeitado(self, resultado: CTeOSResult) -> bool:
        """
        Verifica se o CT-e OS foi rejeitado
        
        Args:
            resultado: Resultado do envio
            
        Returns:
            bool: True se foi rejeitado
        """
        return resultado.success and resultado.c_stat == StatusCTe.REJEITADA.value

# Exemplo de uso
def main():
    sender = CTeOSSender(
        'https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb',
        'YWRtaW46MTIzbXVkYXI='
    )
    
    resultado = sender.enviar('arquivo.txt', {
        'grupo': 'GRUPO_EMPRESA',
        'cnpj': '11111111111111'
    })
    
    if resultado.success:
        print(f"CT-e OS enviado com sucesso!")
        print(f"Lote: {resultado.numero_lote}")
        print(f"Chave: {resultado.chave}")
        print(f"Status: {resultado.status}")
        print(f"Mensagem: {resultado.mensagem}")
        
        if sender.foi_autorizado(resultado):
            print("üéâ CT-e OS autorizado pela SEFAZ!")
        elif sender.foi_rejeitado(resultado):
            print("‚ùå CT-e OS rejeitado pela SEFAZ")
    else:
        print(f"Erro no envio: {resultado.error}")

if __name__ == "__main__":
    main()
```

### **PHP**

```php
<?php

class CTeOSSender {
    private $baseUrl;
    private $authToken;
    private $httpClient;
    
    public function __construct($baseUrl, $authToken) {
        $this->baseUrl = $baseUrl;
        $this->authToken = $authToken;
        $this->httpClient = new HttpClient();
    }
    
    /**
     * Envia CT-e OS para a SEFAZ
     * 
     * @param string $arquivoPath Caminho para o arquivo TX2 ou XML
     * @param array $params Par√¢metros do envio
     * @return array Resultado do envio
     * @throws Exception
     */
    public function enviar($arquivoPath, $params) {
        $url = $this->baseUrl . '/cteos/envia';
        
        $headers = [
            'Authorization: Basic ' . $this->authToken
        ];
        
        // L√™ o arquivo
        if (!file_exists($arquivoPath)) {
            return [
                'success' => false,
                'error' => "Arquivo n√£o encontrado: {$arquivoPath}"
            ];
        }
        
        $arquivo = file_get_contents($arquivoPath);
        
        // Cria arquivo tempor√°rio
        $tempFile = tempnam(sys_get_temp_dir(), 'cte_');
        file_put_contents($tempFile, $arquivo);
        
        $postData = [
            'Grupo' => $params['grupo'],
            'CNPJ' => $params['cnpj'],
            'Arquivo' => new CURLFile($tempFile, 'text/plain', 'arquivo.txt')
        ];
        
        try {
            $response = $this->httpClient->post($url, $postData, $headers);
            
            // Remove arquivo tempor√°rio
            unlink($tempFile);
            
            // Verifica se √© uma resposta de sucesso ou erro
            if (strpos($response, 'EXCEPTION') !== false) {
                return [
                    'success' => false,
                    'error' => $response
                ];
            } else {
                // Parse da resposta de sucesso
                $partes = array_map('trim', explode(',', $response));
                if (count($partes) >= 4) {
                    $cStat = intval($partes[2]);
                    return [
                        'success' => true,
                        'numero_lote' => $partes[0],
                        'chave' => $partes[1],
                        'c_stat' => $cStat,
                        'mensagem' => $partes[3],
                        'status' => $this->interpretarStatus($cStat),
                        'raw' => $response
                    ];
                } else {
                    return [
                        'success' => false,
                        'error' => 'Formato de resposta inv√°lido'
                    ];
                }
            }
            
        } catch (Exception $e) {
            // Remove arquivo tempor√°rio em caso de erro
            if (file_exists($tempFile)) {
                unlink($tempFile);
            }
            
            return [
                'success' => false,
                'error' => $e->getMessage()
            ];
        }
    }
    
    /**
     * Interpreta o c√≥digo de status da SEFAZ
     * 
     * @param int $cStat C√≥digo de status
     * @return string Descri√ß√£o do status
     */
    public function interpretarStatus($cStat) {
        $statusMap = [
            100 => 'AUTORIZADA',
            101 => 'CANCELADA',
            102 => 'INUTILIZADA',
            103 => 'DENEGADA',
            104 => 'REJEITADA'
        ];
        
        return $statusMap[$cStat] ?? 'DESCONHECIDO';
    }
    
    /**
     * Verifica se o CT-e OS foi autorizado
     * 
     * @param array $resultado Resultado do envio
     * @return bool True se foi autorizado
     */
    public function foiAutorizado($resultado) {
        return $resultado['success'] && $resultado['c_stat'] === 100;
    }
    
    /**
     * Verifica se o CT-e OS foi rejeitado
     * 
     * @param array $resultado Resultado do envio
     * @return bool True se foi rejeitado
     */
    public function foiRejeitado($resultado) {
        return $resultado['success'] && $resultado['c_stat'] === 104;
    }
    
    /**
     * Valida par√¢metros antes do envio
     * 
     * @param array $params Par√¢metros do envio
     * @return array Resultado da valida√ß√£o
     */
    public function validarParametros($params) {
        $erros = [];
        
        if (empty($params['grupo'])) {
            $erros[] = 'Grupo √© obrigat√≥rio';
        }
        
        if (empty($params['cnpj'])) {
            $erros[] = 'CNPJ √© obrigat√≥rio';
        } elseif (!preg_match('/^\d{14}$/', $params['cnpj'])) {
            $erros[] = 'CNPJ deve ter 14 d√≠gitos num√©ricos';
        }
        
        return [
            'valido' => empty($erros),
            'erros' => $erros
        ];
    }
}

class HttpClient {
    public function post($url, $data, $headers = []) {
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $url);
        curl_setopt($ch, CURLOPT_POST, true);
        curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
        curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($ch, CURLOPT_TIMEOUT, 60);
        
        $response = curl_exec($ch);
        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
        $error = curl_error($ch);
        curl_close($ch);
        
        if ($error) {
            throw new Exception("Erro cURL: {$error}");
        }
        
        if ($httpCode !== 200) {
            throw new Exception("Erro HTTP: {$httpCode}");
        }
        
        return $response;
    }
}

// Exemplo de uso
try {
    $sender = new CTeOSSender(
        'https://managersaas.tecnospeed.com.br:8081/ManagerAPIWeb',
        'YWRtaW46MTIzbXVkYXI='
    );
    
    $params = [
        'grupo' => 'GRUPO_EMPRESA',
        'cnpj' => '11111111111111'
    ];
    
    // Valida par√¢metros
    $validacao = $sender->validarParametros($params);
    if (!$validacao['valido']) {
        echo "Erros de valida√ß√£o:\n";
        foreach ($validacao['erros'] as $erro) {
            echo "- {$erro}\n";
        }
        exit;
    }
    
    // Envia CT-e OS
    $resultado = $sender->enviar('arquivo.txt', $params);
    
    if ($resultado['success']) {
        echo "CT-e OS enviado com sucesso!\n";
        echo "Lote: " . $resultado['numero_lote'] . "\n";
        echo "Chave: " . $resultado['chave'] . "\n";
        echo "Status: " . $resultado['status'] . "\n";
        echo "Mensagem: " . $resultado['mensagem'] . "\n";
        
        if ($sender->foiAutorizado($resultado)) {
            echo "üéâ CT-e OS autorizado pela SEFAZ!\n";
        } elseif ($sender->foiRejeitado($resultado)) {
            echo "‚ùå CT-e OS rejeitado pela SEFAZ\n";
        }
    } else {
        echo "Erro no envio: " . $resultado['error'] . "\n";
    }
    
} catch (Exception $e) {
    echo "Erro: " . $e->getMessage() . "\n";
}
?>
```

## Fluxo de Envio

### **1. Processo de Envio**

```mermaid
flowchart TD
    A[In√≠cio] --> B[Validar Par√¢metros]
    B --> C{Par√¢metros V√°lidos?}
    C -->|N√£o| D[Erro: Par√¢metros inv√°lidos]
    C -->|Sim| E[Ler Arquivo TX2/XML]
    E --> F{Arquivo V√°lido?}
    F -->|N√£o| G[Erro: Arquivo inv√°lido]
    F -->|Sim| H[Enviar para SEFAZ]
    H --> I{Resposta da SEFAZ}
    I -->|Autorizado| J[Sucesso: CT-e OS autorizado]
    I -->|Rejeitado| K[Erro: CT-e OS rejeitado]
    I -->|Erro T√©cnico| L[Erro: Falha na comunica√ß√£o]
```

### **2. Valida√ß√µes Realizadas**

1. **Valida√ß√£o de Par√¢metros**
   - Grupo configurado no SaaS
   - CNPJ v√°lido (14 d√≠gitos)
   - Arquivo presente e leg√≠vel

2. **Valida√ß√£o do Arquivo**
   - Formato TX2 ou XML v√°lido
   - Estrutura conforme especifica√ß√£o
   - Vers√£o compat√≠vel (3.00)

3. **Valida√ß√£o na SEFAZ**
   - Assinatura digital v√°lida
   - Dados fiscais corretos
   - Conformidade com esquemas

## Casos de Uso

### **1. Emiss√£o de CT-e OS Normal**
- Envio de CT-e OS para transporte de mercadorias
- Resposta imediata de autoriza√ß√£o
- Gera√ß√£o autom√°tica de chave de acesso

### **2. Emiss√£o em Lote**
- M√∫ltiplos CT-e OS em sequ√™ncia
- Controle de numera√ß√£o sequencial
- Tratamento individual de cada resposta

### **3. Corre√ß√£o e Reenvio**
- CT-e OS rejeitado pela SEFAZ
- Corre√ß√£o dos dados incorretos
- Reenvio com nova valida√ß√£o

### **4. Testes e Homologa√ß√£o**
- Ambiente de testes (tpAmb=2)
- Valida√ß√£o de estrutura e dados
- Verifica√ß√£o de conformidade

## Tratamento de Erros

### **Erros de Valida√ß√£o**

| Erro | Causa | Solu√ß√£o |
|------|-------|---------|
| **EspdSchemaValidationException** | Vers√£o ou estrutura inv√°lida | Verificar vers√£o (3.00) e estrutura XML |
| **EspdManCTeOSAssinarException** | Problema na assinatura | Verificar certificado digital |
| **EspdCheckParamsException** | Par√¢metros inv√°lidos | Verificar grupo, CNPJ e arquivo |
| **EspdFileNotFoundException** | Arquivo n√£o encontrado | Verificar caminho e permiss√µes |

### **Erros da SEFAZ**

| C√≥digo | Status | Descri√ß√£o | A√ß√£o |
|--------|--------|-----------|------|
| `100` | ‚úÖ **AUTORIZADA** | CT-e OS autorizado | Download dos arquivos |
| `104` | ‚ùå **REJEITADA** | CT-e OS rejeitado | Corrigir dados e reenviar |
| `103` | ‚ùå **DENEGADA** | CT-e OS denegado | Verificar conformidade |
| `102` | ‚ùå **INUTILIZADA** | CT-e OS inutilizado | Verificar numera√ß√£o |

### **Valida√ß√µes Recomendadas**

#### **Antes do Envio**
- ‚úÖ Verificar formato do arquivo TX2/XML
- ‚úÖ Validar par√¢metros obrigat√≥rios
- ‚úÖ Confirmar vers√£o compat√≠vel (3.00)
- ‚úÖ Verificar certificado digital v√°lido

#### **Ap√≥s o Envio**
- ‚úÖ Interpretar c√≥digo de status
- ‚úÖ Armazenar chave de acesso
- ‚úÖ Registrar n√∫mero do lote
- ‚úÖ Tratar erros de rejei√ß√£o

## Limita√ß√µes e Considera√ß√µes

### **Limita√ß√µes T√©cnicas**
- **Comunica√ß√£o s√≠ncrona**: Requisi√ß√£o bloqueante at√© resposta da SEFAZ
- **Timeout**: Poss√≠vel timeout em caso de lentid√£o da SEFAZ
- **Arquivo √∫nico**: Um arquivo por requisi√ß√£o
- **Tamanho**: Limite de tamanho do arquivo

### **Considera√ß√µes de Neg√≥cio**
- **Numera√ß√£o sequencial**: Controle autom√°tico de numera√ß√£o
- **Ambiente**: Separa√ß√£o entre homologa√ß√£o e produ√ß√£o
- **Auditoria**: Todas as opera√ß√µes s√£o registradas
- **Conformidade**: Valida√ß√£o autom√°tica de regras fiscais

### **Seguran√ßa**
- **Autentica√ß√£o**: Sempre use credenciais v√°lidas
- **Certificado**: Certificado digital A1 obrigat√≥rio
- **HTTPS**: Todas as comunica√ß√µes s√£o criptografadas
- **Logs**: Todas as opera√ß√µes s√£o registradas

## Pr√≥ximos Passos

<CardGroup cols={2}>
  <Card
    title="Convers√£o TX2 para XML"
    href="/api/endpoints/conversion"
    icon="file-text"
  >
    Converta arquivos TX2
  </Card>
  <Card
    title="Consulta Avan√ßada"
    href="/api/endpoints/consultation"
    icon="search"
  >
    Consulte documentos existentes
  </Card>
  <Card
    title="Descarte de CT-e OS"
    href="/api/endpoints/disposal"
    icon="trash-2"
  >
    Descarte documentos rejeitados
  </Card>
  <Card
    title="Suporte"
    href="mailto:suporte@managersaas.com"
    icon="message-circle"
  >
    Entre em contato conosco
  </Card>
</CardGroup>

---

üöÄ **Envio S√≠ncrono**: Envie CT-e OS para a SEFAZ e receba resposta imediata de autoriza√ß√£o ou rejei√ß√£o. Para d√∫vidas sobre o processo de envio ou formato TX2, consulte nossa equipe de suporte. 